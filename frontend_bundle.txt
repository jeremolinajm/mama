========== FILE: ./api/admin.ts ==========
import apiClient from './client';
import type {
  Service,
  Product,
  Category,
  Booking,
  Order,
  ConfigEntry,
  BookingStatus,
  OrderStatus,
} from '../types/domain';

/**
 * API module for admin operations
 * All endpoints require JWT authentication
 */

export const adminApi = {
  // ==================== SERVICES ====================
  services: {
    getAll: async (): Promise<Service[]> => {
      const response = await apiClient.get<Service[]>('/api/admin/services');
      return response.data;
    },

    getById: async (id: number): Promise<Service> => {
      const response = await apiClient.get<Service>(`/api/admin/services/${id}`);
      return response.data;
    },

    create: async (service: Partial<Service>): Promise<Service> => {
      const response = await apiClient.post<Service>('/api/admin/services', service);
      return response.data;
    },

    update: async (id: number, service: Partial<Service>): Promise<Service> => {
      const response = await apiClient.put<Service>(`/api/admin/services/${id}`, service);
      return response.data;
    },

    delete: async (id: number): Promise<void> => {
      await apiClient.delete(`/api/admin/services/${id}`);
    },

    toggleFeatured: async (id: number): Promise<Service> => {
      const response = await apiClient.patch<Service>(`/api/admin/services/${id}/featured`);
      return response.data;
    },
  },

  // ==================== PRODUCTS ====================
  products: {
    getAll: async (): Promise<Product[]> => {
      const response = await apiClient.get<Product[]>('/api/admin/products');
      return response.data;
    },

    getById: async (id: number): Promise<Product> => {
      const response = await apiClient.get<Product>(`/api/admin/products/${id}`);
      return response.data;
    },

    create: async (product: Partial<Product>): Promise<Product> => {
      const response = await apiClient.post<Product>('/api/admin/products', product);
      return response.data;
    },

    update: async (id: number, product: Partial<Product>): Promise<Product> => {
      const response = await apiClient.put<Product>(`/api/admin/products/${id}`, product);
      return response.data;
    },

    delete: async (id: number): Promise<void> => {
      await apiClient.delete(`/api/admin/products/${id}`);
    },

    toggleFeatured: async (id: number): Promise<Product> => {
      const response = await apiClient.patch<Product>(`/api/admin/products/${id}/featured`);
      return response.data;
    },

    updateStock: async (id: number, stock: number): Promise<Product> => {
      const response = await apiClient.patch<Product>(`/api/admin/products/${id}/stock`, {
        stock,
      });
      return response.data;
    },
  },

  // ==================== CATEGORIES ====================
  categories: {
    getAll: async (): Promise<Category[]> => {
      const response = await apiClient.get<Category[]>('/api/admin/categories');
      return response.data;
    },

    create: async (category: Partial<Category>): Promise<Category> => {
      const response = await apiClient.post<Category>('/api/admin/categories', category);
      return response.data;
    },

    update: async (id: number, category: Partial<Category>): Promise<Category> => {
      const response = await apiClient.put<Category>(`/api/admin/categories/${id}`, category);
      return response.data;
    },

    delete: async (id: number): Promise<void> => {
      await apiClient.delete(`/api/admin/categories/${id}`);
    },
  },

  // ==================== BOOKINGS ====================
  bookings: {
    getAll: async (filters?: {
      startDate?: string;
      endDate?: string;
      status?: BookingStatus;
    }): Promise<Booking[]> => {
      const params = new URLSearchParams();
      if (filters?.startDate) params.append('startDate', filters.startDate);
      if (filters?.endDate) params.append('endDate', filters.endDate);
      if (filters?.status) params.append('status', filters.status);

      const response = await apiClient.get<Booking[]>(`/api/admin/bookings?${params.toString()}`);
      return response.data;
    },

    updateStatus: async (id: number, status: BookingStatus): Promise<Booking> => {
      const response = await apiClient.patch<Booking>(`/api/admin/bookings/${id}/status`, {
        status,
      });
      return response.data;
    },

    cancel: async (id: number): Promise<void> => {
      await apiClient.delete(`/api/admin/bookings/${id}`);
    },
  },

  // ==================== ORDERS ====================
  orders: {
    getAll: async (filters?: {
      startDate?: string;
      endDate?: string;
      status?: OrderStatus;
    }): Promise<Order[]> => {
      const params = new URLSearchParams();
      if (filters?.startDate) params.append('startDate', filters.startDate);
      if (filters?.endDate) params.append('endDate', filters.endDate);
      if (filters?.status) params.append('status', filters.status);

      const response = await apiClient.get<Order[]>(`/api/admin/orders?${params.toString()}`);
      return response.data;
    },

    updateStatus: async (id: number, status: OrderStatus): Promise<Order> => {
      const response = await apiClient.patch<Order>(`/api/admin/orders/${id}/status`, {
        status,
      });
      return response.data;
    },
  },

  // ==================== CONFIG ====================
  config: {
    getAll: async (): Promise<ConfigEntry[]> => {
      const response = await apiClient.get<ConfigEntry[]>('/api/admin/config');
      return response.data;
    },

    update: async (key: string, value: string): Promise<ConfigEntry> => {
      const response = await apiClient.put<ConfigEntry>(`/api/admin/config/${key}`, { value });
      return response.data;
    },
  },
};


========== FILE: ./api/auth.ts ==========
import apiClient from './client';
import type { LoginRequest, LoginResponse } from '../types/domain';

/**
 * API module for authentication
 */

export const authApi = {
  /**
   * Admin login
   */
  login: async (request: LoginRequest): Promise<LoginResponse> => {
    const response = await apiClient.post<LoginResponse>('/api/auth/login', request);
    return response.data;
  },
};


========== FILE: ./api/categorias.ts ==========
import apiClient from './client';
import type { Category, CategoryType } from '../types/domain';

/**
 * API module for categories
 */

export const categoriasApi = {
  /**
   * Get all active categories
   */
  getAll: async (): Promise<Category[]> => {
    const response = await apiClient.get<Category[]>('/api/public/categories');
    return response.data;
  },

  /**
   * Get categories by type (SERVICE or PRODUCT)
   */
  getByType: async (type: CategoryType): Promise<Category[]> => {
    const response = await apiClient.get<Category[]>(`/api/public/categories/type/${type}`);
    return response.data;
  },
};


========== FILE: ./api/client.ts ==========
import axios from 'axios';
import type { AxiosInstance, InternalAxiosRequestConfig } from 'axios';

const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

const API_BASE_URL = isLocalhost 
  ? 'http://localhost:8080' 
  : (import.meta.env.VITE_API_BASE_URL || 'https://api.flaviadermobeauty.com');
  
// Create axios instance
const apiClient: AxiosInstance = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    'Content-Type': 'application/json',
  },
  timeout: 30000, // 30 seconds
});

// Request interceptor: Add JWT token from localStorage
apiClient.interceptors.request.use(
  (config: InternalAxiosRequestConfig) => {
    const token = localStorage.getItem('authToken');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// Response interceptor: Handle 401 errors (unauthorized) and unwrap ApiResponse
apiClient.interceptors.response.use(
  (response) => {
    // Unwrap ApiResponse format {success: true, data: ...}
    if (response.data && typeof response.data === 'object' && 'data' in response.data) {
      response.data = response.data.data;
    }
    return response;
  },
  (error) => {
    if (error.response?.status === 401) {
      // Clear token and redirect to login
      localStorage.removeItem('authToken');

      // Only redirect if not already on login page
      if (!window.location.pathname.includes('/admin/login')) {
        window.location.href = '/admin/login';
      }
    }
    return Promise.reject(error);
  }
);

export default apiClient;


========== FILE: ./api/pedidos.ts ==========
import apiClient from './client';
import type {
  CreateOrderRequest,
  OrderResponse,
  PaymentPreferenceResponse,
} from '../types/domain';

/**
 * API module for orders (pedidos)
 */

export const pedidosApi = {
  /**
   * Create a new order
   */
  create: async (request: CreateOrderRequest): Promise<OrderResponse> => {
    const response = await apiClient.post<OrderResponse>('/api/public/orders', request);
    return response.data;
  },

  /**
   * Get order by order number
   */
  getByNumber: async (orderNumber: string): Promise<OrderResponse> => {
    const response = await apiClient.get<OrderResponse>(`/api/public/orders/${orderNumber}`);
    return response.data;
  },

  /**
   * Create Mercado Pago payment preference for an order
   */
  createPaymentPreference: async (orderId: number): Promise<PaymentPreferenceResponse> => {
    const response = await apiClient.post<PaymentPreferenceResponse>(
      `/api/public/payments/orders/${orderId}/preference`
    );
    return response.data;
  },
};


========== FILE: ./api/productos.ts ==========
import apiClient from './client';
import type { Product } from '../types/domain';

/**
 * API module for products
 */

export const productosApi = {
  /**
   * Get all active products
   */
  getAll: async (): Promise<Product[]> => {
    const response = await apiClient.get<Product[]>('/api/public/products');
    return response.data;
  },

  /**
   * Get featured products
   */
  getFeatured: async (): Promise<Product[]> => {
    const response = await apiClient.get<Product[]>('/api/public/products/featured');
    return response.data;
  },

  /**
   * Get product by ID
   */
  getById: async (id: number): Promise<Product> => {
    const response = await apiClient.get<Product>(`/api/public/products/${id}`);
    return response.data;
  },

  /**
   * Get products by category
   */
  getByCategory: async (categoryId: number): Promise<Product[]> => {
    const response = await apiClient.get<Product[]>(`/api/public/products/category/${categoryId}`);
    return response.data;
  },

  /**
   * Get trending products
   */
  getTrending: async (): Promise<Product[]> => {
    const response = await apiClient.get<Product[]>('/api/public/products/trending');
    return response.data;
  },

  /**
   * Get offer products
   */
  getOffers: async (): Promise<Product[]> => {
    const response = await apiClient.get<Product[]>('/api/public/products/offers');
    return response.data;
  },
};


========== FILE: ./api/servicios.ts ==========
import apiClient from './client';
import type { Service } from '../types/domain';

/**
 * API module for services
 */

export const serviciosApi = {
  /**
   * Get all active services
   */
  getAll: async (): Promise<Service[]> => {
    const response = await apiClient.get<Service[]>('/api/public/services');
    return response.data;
  },

  /**
   * Get featured services
   */
  getFeatured: async (): Promise<Service[]> => {
    const response = await apiClient.get<Service[]>('/api/public/services/featured');
    return response.data;
  },

  /**
   * Get service by ID
   */
  getById: async (id: number): Promise<Service> => {
    const response = await apiClient.get<Service>(`/api/public/services/${id}`);
    return response.data;
  },

  /**
   * Get services by category
   */
  getByCategory: async (categoryId: number): Promise<Service[]> => {
    const response = await apiClient.get<Service[]>(`/api/public/services/category/${categoryId}`);
    return response.data;
  },
};


========== FILE: ./api/turnos.ts ==========
import apiClient from './client';
import type {
  CreateBookingRequest,
  BookingResponse,
  PaymentPreferenceResponse,
} from '../types/domain';

export const turnosApi = {
  // ... (mantén los métodos create, getByNumber, createPaymentPreference igual que antes)

  create: async (request: CreateBookingRequest): Promise<BookingResponse> => {
    const response = await apiClient.post<BookingResponse>('/api/public/bookings', request);
    return response.data;
  },

  getByNumber: async (bookingNumber: string): Promise<BookingResponse> => {
    const response = await apiClient.get<BookingResponse>(`/api/public/bookings/${bookingNumber}`);
    return response.data;
  },

  createPaymentPreference: async (bookingId: number): Promise<PaymentPreferenceResponse> => {
    const response = await apiClient.post<PaymentPreferenceResponse>(
      `/api/public/payments/bookings/${bookingId}/preference`
    );
    return response.data;
  },

  // NUEVO MÉTODO: Obtener disponibilidad real
  getAvailability: async (serviceId: number, date: string): Promise<string[]> => {
    // El backend espera: /api/public/availability?serviceId=X&date=YYYY-MM-DD
    const response = await apiClient.get<string[]>('/api/public/availability', {
      params: { serviceId, date }
    });
    return response.data; // Devuelve array de strings ["09:00", "09:30", ...]
  }
};

========== FILE: ./api/upload.ts ==========
import apiClient from './client';

/**
 * API module for file uploads
 */

interface UploadResponse {
  url: string;
}

export const uploadApi = {
  /**
   * Upload an image file
   */
  uploadImage: async (file: File): Promise<string> => {
    const formData = new FormData();
    formData.append('file', file);

    const response = await apiClient.post<UploadResponse>('/api/admin/uploads', formData, {
      headers: {
        'Content-Type': 'multipart/form-data',
      },
    });

    return response.data.url;
  },
};


========== FILE: ./App.tsx ==========
import { BrowserRouter, Routes, Route } from 'react-router-dom';
import { CartProvider } from './context/CartContext';
import { AuthProvider } from './context/AuthContext';
import ScrollToTop from './components/common/ScrollToTop';

// Layouts
import MainLayout from './layout/MainLayout';
import AdminLayout from './layout/AdminLayout';

// Public Pages
import HomePage from './pages/HomePage';
import ServiciosPage from './pages/ServiciosPage';
import ProductosPage from './pages/ProductosPage';
import FlaviaPage from './pages/FlaviaPage';
import CarritoPage from './pages/CarritoPage';
import ReservarTurnoPage from './pages/ReservarTurnoPage';
import ProductDetailPage from './pages/ProductDetailPage';

// Admin Pages
import AdminLoginPage from './pages/admin/AdminLoginPage';
import AdminDashboardPage from './pages/admin/AdminDashboardPage';
import AdminServiciosPage from './pages/admin/AdminServiciosPage';
import AdminProductosPage from './pages/admin/AdminProductosPage';
import AdminTurnosPage from './pages/admin/AdminTurnosPage';
import AdminPedidosPage from './pages/admin/AdminPedidosPage';
import AdminConfigPage from './pages/admin/AdminConfigPage'; 
import PaymentFailurePage from './pages/PaymentFailurePage';
import PaymentSuccessPage from './pages/PaymentSuccessPage';

/**
 * Main App component with routing
 * Wrapped with CartProvider and AuthProvider
 */

function App() {
  return (
    <AuthProvider>
      <CartProvider>
        <BrowserRouter>
          <ScrollToTop />
          <Routes>
            {/* Public routes with MainLayout */}
            <Route element={<MainLayout />}>
              <Route path="/" element={<HomePage />} />
              <Route path="/servicios" element={<ServiciosPage />} />
              <Route path="/servicios/:serviceSlug/reservar" element={<ReservarTurnoPage />} />
              <Route path='/reservar' element={<ReservarTurnoPage />} />
              <Route path="/reserva/exitosa" element={<PaymentSuccessPage />} />
              <Route path="/reserva/fallida" element={<PaymentFailurePage />} />
              <Route path="/reserva/pendiente" element={<PaymentSuccessPage />} /> 
              <Route path="/productos" element={<ProductosPage />} />
              <Route path="/productos/:slug" element={<ProductDetailPage />} />
              <Route path="/flavia" element={<FlaviaPage />} />
              <Route path="/carrito" element={<CarritoPage />} />
              <Route path="/pedido/exitoso" element={<PaymentSuccessPage />} />
              <Route path="/pedido/fallido" element={<PaymentFailurePage />} />
            </Route>

            {/* Admin login (no layout) */}
            <Route path="/admin/login" element={<AdminLoginPage />} />

            {/* Protected admin routes */}
            <Route path="/admin" element={<AdminLayout />}>
              <Route index element={<AdminDashboardPage />} />
              <Route path="servicios" element={<AdminServiciosPage />} />
              <Route path="productos" element={<AdminProductosPage />} />
              <Route path="turnos" element={<AdminTurnosPage />} />
              <Route path="pedidos" element={<AdminPedidosPage />} />
              <Route path="config" element={<AdminConfigPage />} />
            </Route>
          </Routes>
        </BrowserRouter>
      </CartProvider>
    </AuthProvider>
  );
}

export default App;


========== FILE: ./components/admin/calendar/DayView.tsx ==========
import { format } from 'date-fns';
import { es } from 'date-fns/locale';
import type { Booking } from '../../../types/domain';

interface DayViewProps {
  currentDate: Date;
  bookings: Booking[];
}

export default function DayView({ currentDate, bookings }: DayViewProps) {
  // Generar horas de 8 a 20
  const hours = Array.from({ length: 13 }, (_, i) => i + 8);
  
  // Filtrar turnos del día
  const dayBookings = bookings.filter(b => b.bookingDate === format(currentDate, 'yyyy-MM-dd'));

  return (
    <div className="bg-white rounded-3xl shadow-soft overflow-hidden border border-gray-100 flex flex-col h-[600px]">
      <div className="p-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center">
         <h3 className="font-serif font-bold text-lg capitalize text-primary">
            {format(currentDate, 'EEEE d, MMMM', { locale: es })}
         </h3>
         <span className="text-sm text-gray-500">{dayBookings.length} turnos agendados</span>
      </div>

      <div className="flex-1 overflow-y-auto relative">
        <div className="flex min-h-[800px]">
          {/* Columna Horas */}
          <div className="w-16 border-r border-gray-100 bg-gray-50/50 flex-shrink-0">
            {hours.map(hour => (
              <div key={hour} className="h-[66px] border-b border-gray-100 text-xs text-gray-400 p-2 text-right">
                {hour}:00
              </div>
            ))}
          </div>

          {/* Columna Turnos (Canvas) */}
          <div className="flex-1 relative bg-[url('/grid-pattern.png')]"> 
            {/* Líneas guía */}
            {hours.map(hour => (
               <div key={`line-${hour}`} className="h-[66px] border-b border-gray-100 w-full absolute" style={{ top: `${(hour - 8) * 66}px` }}></div>
            ))}

            {/* Bloques de Turnos */}
            {dayBookings.map(booking => {
               // Calculo simplificado de posición absoluta en pixeles (66px por hora)
               const [h, m] = booking.bookingTime.split(':').map(Number);
               const topPx = (h - 8) * 66 + (m / 60) * 66;
               const heightPx = (booking.durationMinutes / 60) * 66;

               return (
                <div
                  key={booking.id}
                  className="absolute left-2 right-2 rounded-xl bg-accent/10 border-l-4 border-accent p-2 hover:bg-accent/20 transition-colors cursor-pointer shadow-sm overflow-hidden"
                  style={{ top: `${topPx}px`, height: `${heightPx}px` }}
                  title={`${booking.serviceName} - ${booking.customerName}`}
                >
                  <p className="text-xs font-bold text-primary truncate">{booking.bookingTime.slice(0,5)} - {booking.customerName}</p>
                  <p className="text-[10px] text-gray-500 truncate">{booking.serviceName}</p>
                </div>
               );
            })}
          </div>
        </div>
      </div>
    </div>
  );
}

========== FILE: ./components/admin/calendar/MonthView.tsx ==========
import { 
  startOfMonth, 
  endOfMonth, 
  eachDayOfInterval, 
  format, 
  getDay, 
  isSameDay, 
  isToday 
} from 'date-fns';
import type { Booking } from '../../../types/domain';

interface MonthViewProps {
  currentDate: Date;
  bookings: Booking[];
  onDaySelect: (date: Date) => void;
}

export default function MonthView({ currentDate, bookings, onDaySelect }: MonthViewProps) {
  const monthStart = startOfMonth(currentDate);
  const monthEnd = endOfMonth(currentDate);
  const days = eachDayOfInterval({ start: monthStart, end: monthEnd });
  const startDay = getDay(monthStart);

  const weekDays = ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'];

  return (
    <div className="bg-white rounded-3xl shadow-soft overflow-hidden animate-fade-in border border-gray-100">
      {/* Header Semanal */}
      <div className="grid grid-cols-7 bg-gray-50 border-b border-gray-200">
        {weekDays.map(day => (
          <div key={day} className="py-3 text-center text-xs font-bold text-gray-400 uppercase tracking-wider">
            {day}
          </div>
        ))}
      </div>

      {/* Grilla Días */}
      <div className="grid grid-cols-7 auto-rows-[120px]">
        {/* Espacios vacíos */}
        {Array.from({ length: startDay }).map((_, i) => (
          <div key={`empty-${i}`} className="bg-gray-50/30 border-b border-r border-gray-100" />
        ))}

        {days.map((day) => {
          // Filtrar turnos de este día
          const dayBookings = bookings.filter(b => isSameDay(new Date(b.bookingDate + 'T00:00:00'), day));
          
          return (
            <div 
              key={day.toString()}
              onClick={() => onDaySelect(day)}
              className={`border-b border-r border-gray-100 p-2 transition-all cursor-pointer hover:bg-accent/5 group relative
                ${isToday(day) ? 'bg-accent/5' : ''}
              `}
            >
              <div className="flex justify-between items-start">
                <span className={`
                  w-7 h-7 flex items-center justify-center rounded-full text-sm font-bold
                  ${isToday(day) ? 'bg-accent text-white' : 'text-gray-700 group-hover:text-accent'}
                `}>
                  {format(day, 'd')}
                </span>
                {dayBookings.length > 0 && (
                   <span className="text-[10px] bg-gray-100 px-1.5 py-0.5 rounded text-gray-500 font-medium">
                     {dayBookings.length} citas
                   </span>
                )}
              </div>

              {/* Lista mini de turnos */}
              <div className="mt-2 space-y-1 overflow-y-auto max-h-[80px] no-scrollbar">
                {dayBookings.slice(0, 3).map(booking => (
                  <div key={booking.id} className="text-[10px] px-1.5 py-0.5 rounded bg-blue-50 text-blue-600 truncate border-l-2 border-blue-400">
                    {booking.bookingTime.slice(0, 5)} {booking.customerName.split(' ')[0]}
                  </div>
                ))}
                {dayBookings.length > 3 && (
                  <div className="text-[10px] text-gray-400 pl-1">+ {dayBookings.length - 3} más</div>
                )}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
}

========== FILE: ./components/admin/calendar/YearView.tsx ==========
import { 
  startOfYear, 
  eachMonthOfInterval, 
  endOfYear, 
  format, 
  getDay, 
  getDaysInMonth 
} from 'date-fns';
import { es } from 'date-fns/locale';

interface YearViewProps {
  currentDate: Date;
  onMonthSelect: (date: Date) => void;
}

export default function YearView({ currentDate, onMonthSelect }: YearViewProps) {
  const yearStart = startOfYear(currentDate);
  const yearEnd = endOfYear(currentDate);
  const months = eachMonthOfInterval({ start: yearStart, end: yearEnd });

  const weekDays = ['D', 'L', 'M', 'M', 'J', 'V', 'S'];

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in">
      {months.map((month) => {
        const daysInMonth = getDaysInMonth(month);
        const startDay = getDay(month); // 0 = Domingo
        
        return (
          <div 
            key={month.toString()} 
            className="bg-white p-4 rounded-2xl border border-gray-100 hover:border-accent hover:shadow-soft transition-all cursor-pointer group"
            onClick={() => onMonthSelect(month)}
          >
            <h3 className="font-serif font-bold text-lg text-primary mb-3 capitalize group-hover:text-accent">
              {format(month, 'MMMM', { locale: es })}
            </h3>
            
            <div className="grid grid-cols-7 gap-1 text-center">
              {weekDays.map(d => (
                <span key={d} className="text-[10px] text-gray-400 font-bold">{d}</span>
              ))}
              
              {/* Espacios vacíos iniciales */}
              {Array.from({ length: startDay }).map((_, i) => (
                <div key={`empty-${i}`} />
              ))}

              {/* Días */}
              {Array.from({ length: daysInMonth }).map((_, i) => (
                <div 
                  key={i} 
                  className="h-6 w-6 flex items-center justify-center text-xs text-gray-600 rounded-full hover:bg-accent/10"
                >
                  {i + 1}
                </div>
              ))}
            </div>
          </div>
        );
      })}
    </div>
  );
}

========== FILE: ./components/admin/ImageUploader.tsx ==========
import { useState, useRef } from 'react';
import { uploadApi } from '../../api/upload';

interface ImageUploaderProps {
  currentImageUrl?: string | null;
  onImageUploaded: (url: string) => void;
}

export default function ImageUploader({ currentImageUrl, onImageUploaded }: ImageUploaderProps) {
  const [uploading, setUploading] = useState(false);
  const [preview, setPreview] = useState<string | null>(currentImageUrl || null);
  const fileInputRef = useRef<HTMLInputElement>(null);

  const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (!file) return;

    // Validaciones básicas de frontend
    if (!file.type.startsWith('image/')) {
      alert('Por favor selecciona un archivo de imagen válido');
      return;
    }
    if (file.size > 5 * 1024 * 1024) { // 5MB
      alert('La imagen no debe superar los 5MB');
      return;
    }

    try {
      setUploading(true);
      // Previsualización inmediata
      const objectUrl = URL.createObjectURL(file);
      setPreview(objectUrl);

      // Subida real
      const url = await uploadApi.uploadImage(file);
      onImageUploaded(url); // Notificar al padre la URL final del servidor
    } catch (error) {
      console.error('Error uploading image:', error);
      alert('Error al subir la imagen. Intenta nuevamente.');
      setPreview(currentImageUrl || null); // Revertir
    } finally {
      setUploading(false);
    }
  };

  return (
    <div className="space-y-2">
      <label className="block text-sm font-medium text-gray-700">Imagen del Producto/Servicio</label>
      
      <div 
        className={`
          relative border-2 border-dashed border-gray-300 rounded-xl p-4 flex flex-col items-center justify-center text-center transition-all cursor-pointer hover:bg-gray-50 hover:border-primary
          ${uploading ? 'opacity-50 pointer-events-none' : ''}
        `}
        onClick={() => fileInputRef.current?.click()}
      >
        <input 
          type="file" 
          ref={fileInputRef} 
          className="hidden" 
          accept="image/jpeg,image/png,image/webp"
          onChange={handleFileChange}
        />

        {preview ? (
          <div className="relative w-full h-48 group">
            <img 
              src={preview} 
              alt="Preview" 
              className="w-full h-full object-contain rounded-lg" 
            />
            <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-lg text-white font-medium">
              Click para cambiar
            </div>
          </div>
        ) : (
          <div className="py-8">
            <div className="mx-auto h-12 w-12 text-gray-400 mb-3">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
              </svg>
            </div>
            <p className="text-sm text-gray-500">
              <span className="font-semibold text-primary">Haz click para subir</span> o arrastra y suelta
            </p>
            <p className="text-xs text-gray-400 mt-1">PNG, JPG, WEBP hasta 5MB</p>
          </div>
        )}

        {uploading && (
          <div className="absolute inset-0 bg-white/80 flex items-center justify-center rounded-xl">
            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
          </div>
        )}
      </div>
    </div>
  );
}

========== FILE: ./components/admin/Modal.tsx ==========
import type { ReactNode } from 'react';

/**
 * Reusable modal component for admin forms
 */

interface ModalProps {
  isOpen: boolean;
  onClose: () => void;
  title: string;
  children: ReactNode;
}

export default function Modal({ isOpen, onClose, title, children }: ModalProps) {
  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-50 overflow-y-auto">
      {/* Backdrop */}
      <div className="fixed inset-0 bg-black bg-opacity-50" onClick={onClose} />

      {/* Modal */}
      <div className="flex min-h-screen items-center justify-center p-4">
        <div className="relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
          {/* Header */}
          <div className="sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between">
            <h2 className="text-xl font-semibold text-gray-800">{title}</h2>
            <button
              onClick={onClose}
              className="text-gray-400 hover:text-gray-600 text-2xl"
            >
              ×
            </button>
          </div>

          {/* Content */}
          <div className="px-6 py-4">{children}</div>
        </div>
      </div>
    </div>
  );
}


========== FILE: ./components/admin/ProductForm.tsx ==========
import { useState, useEffect } from 'react';
import { categoriasApi } from '../../api/categorias';
import { CategoryType } from '../../types/domain';
import type { Product, Category } from '../../types/domain';
import ImageUploader from './ImageUploader';
import { toast } from 'sonner'; // Importamos toast para feedback profesional

interface ProductFormProps {
  product?: Product | null;
  onSubmit: (data: Partial<Product>) => Promise<void>;
  onCancel: () => void;
}

export default function ProductForm({ product, onSubmit, onCancel }: ProductFormProps) {
  const [categories, setCategories] = useState<Category[]>([]);
  const [loading, setLoading] = useState(false);
  
  // Estado para errores de validación local
  const [errors, setErrors] = useState<Record<string, string>>({});

  const [formData, setFormData] = useState({
    name: product?.name || '',
    description: product?.description || '',
    shortDescription: product?.shortDescription || '',
    price: product?.price || 0,
    stock: product?.stock || 0,
    categoryId: product?.categoryId || null as number | null,
    isFeatured: product?.isFeatured || false,
    isOffer: product?.isOffer || false,
    isTrending: product?.isTrending || false,
    isActive: product?.isActive ?? true,
    imageUrl: product?.imageUrl || '',
  });

  useEffect(() => {
    const loadCategories = async () => {
      try {
        const cats = await categoriasApi.getByType(CategoryType.PRODUCT);
        setCategories(cats);
      } catch (err) {
        console.error('Error loading categories:', err);
        toast.error('Error al cargar las categorías');
      }
    };
    loadCategories();
  }, []);

  // Función de validación robusta
  const validate = (): boolean => {
    const newErrors: Record<string, string> = {};

    if (!formData.name.trim()) newErrors.name = 'El nombre es obligatorio';
    if (!formData.description.trim()) newErrors.description = 'La descripción es obligatoria';
    if (formData.price <= 0) newErrors.price = 'El precio debe ser mayor a 0';
    if (!formData.categoryId) newErrors.categoryId = 'Debes seleccionar una categoría';
    
    // Si queremos ser estrictos con la imagen:
    // if (!formData.imageUrl) newErrors.imageUrl = 'La imagen es obligatoria';

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    // 1. Validar antes de enviar
    if (!validate()) {
      toast.error('Faltan datos obligatorios', {
        description: 'Por favor revisa los campos marcados en rojo.'
      });
      return;
    }

    setLoading(true);
    try {
      await onSubmit(formData);
    } catch {
      // El error global ya se maneja en la página padre, pero aquí liberamos el loading
    } finally {
      setLoading(false);
    }
  };

  // Helper para clases de inputs
  const getInputClass = (field: string) => `
    w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-all
    ${errors[field] 
      ? 'border-red-500 focus:ring-red-200 bg-red-50' 
      : 'border-gray-200 focus:ring-primary/20 focus:border-primary'
    }
  `;

  return (
    <form onSubmit={handleSubmit} className="space-y-5 animate-fade-in">
      
      {/* Nombre */}
      <div>
        <label className="block text-sm font-bold text-gray-700 mb-1">
          Nombre del Producto <span className="text-red-500">*</span>
        </label>
        <input
          type="text"
          value={formData.name}
          onChange={(e) => {
            setFormData({ ...formData, name: e.target.value });
            if (errors.name) setErrors({ ...errors, name: '' }); // Limpiar error al escribir
          }}
          className={getInputClass('name')}
          placeholder="Ej: Serum Vitamina C"
        />
        {errors.name && <p className="text-xs text-red-500 mt-1 font-medium">{errors.name}</p>}
      </div>

      {/* Descripción Corta */}
      <div>
        <label className="block text-sm font-bold text-gray-700 mb-1">
          Descripción Corta
        </label>
        <input
          type="text"
          value={formData.shortDescription}
          onChange={(e) => setFormData({ ...formData, shortDescription: e.target.value })}
          className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
          maxLength={100}
          placeholder="Breve resumen para la tarjeta..."
        />
      </div>

      {/* Descripción Completa */}
      <div>
        <label className="block text-sm font-bold text-gray-700 mb-1">
          Descripción Completa <span className="text-red-500">*</span>
        </label>
        <textarea
          value={formData.description}
          onChange={(e) => {
            setFormData({ ...formData, description: e.target.value });
            if (errors.description) setErrors({ ...errors, description: '' });
          }}
          rows={4}
          className={getInputClass('description')}
          placeholder="Detalles, beneficios y modo de uso..."
        />
        {errors.description && <p className="text-xs text-red-500 mt-1 font-medium">{errors.description}</p>}
      </div>

      <div className="grid grid-cols-2 gap-4">
        {/* Precio */}
        <div>
          <label className="block text-sm font-bold text-gray-700 mb-1">Precio <span className="text-red-500">*</span></label>
          <div className="relative">
            <span className="absolute left-3 top-2 text-gray-500">$</span>
            <input
              type="number"
              value={formData.price}
              onChange={(e) => {
                const val = parseFloat(e.target.value);
                setFormData({ ...formData, price: isNaN(val) ? 0 : val });
                if (errors.price) setErrors({ ...errors, price: '' });
              }}
              min="0"
              step="0.01"
              className={`${getInputClass('price')} pl-8`}
            />
          </div>
          {errors.price && <p className="text-xs text-red-500 mt-1 font-medium">{errors.price}</p>}
        </div>

        {/* Stock */}
        <div>
          <label className="block text-sm font-bold text-gray-700 mb-1">Stock Inicial</label>
          <input
            type="number"
            value={formData.stock}
            onChange={(e) => {
              const val = parseInt(e.target.value);
              setFormData({ ...formData, stock: isNaN(val) ? 0 : val });
            }}
            min="0"
            className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"
          />
        </div>
      </div>

      {/* Categoría - AQUÍ ESTABA EL PROBLEMA */}
      <div>
        <label className="block text-sm font-bold text-gray-700 mb-1">
          Categoría <span className="text-red-500">*</span>
        </label>
        <select
          value={formData.categoryId || ''}
          onChange={(e) => {
            setFormData({ ...formData, categoryId: e.target.value ? parseInt(e.target.value) : null });
            if (errors.categoryId) setErrors({ ...errors, categoryId: '' });
          }}
          className={getInputClass('categoryId')}
        >
          <option value="">-- Seleccionar Categoría --</option>
          {categories.map((cat) => (
            <option key={cat.id} value={cat.id}>
              {cat.name}
            </option>
          ))}
        </select>
        {errors.categoryId && (
          <p className="text-xs text-red-500 mt-1 font-medium flex items-center gap-1">
            ⚠ {errors.categoryId}
          </p>
        )}
      </div>

      {/* Imagen */}
      <div>
        <ImageUploader 
          currentImageUrl={formData.imageUrl}
          onImageUploaded={(url) => setFormData({ ...formData, imageUrl: url })}
        />
      </div>

      {/* Toggles / Checkboxes */}
      <div className="grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-xl border border-gray-100">
        <label className="flex items-center gap-3 cursor-pointer">
          <input
            type="checkbox"
            checked={formData.isFeatured}
            onChange={(e) => setFormData({ ...formData, isFeatured: e.target.checked })}
            className="w-5 h-5 text-primary rounded focus:ring-primary border-gray-300"
          />
          <span className="text-sm text-gray-700 font-medium">Destacado</span>
        </label>

        <label className="flex items-center gap-3 cursor-pointer">
          <input
            type="checkbox"
            checked={formData.isOffer}
            onChange={(e) => setFormData({ ...formData, isOffer: e.target.checked })}
            className="w-5 h-5 text-primary rounded focus:ring-primary border-gray-300"
          />
          <span className="text-sm text-gray-700 font-medium">En oferta</span>
        </label>

        <label className="flex items-center gap-3 cursor-pointer">
          <input
            type="checkbox"
            checked={formData.isTrending}
            onChange={(e) => setFormData({ ...formData, isTrending: e.target.checked })}
            className="w-5 h-5 text-primary rounded focus:ring-primary border-gray-300"
          />
          <span className="text-sm text-gray-700 font-medium">Tendencia</span>
        </label>

        <label className="flex items-center gap-3 cursor-pointer">
          <input
            type="checkbox"
            checked={formData.isActive}
            onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}
            className="w-5 h-5 text-green-600 rounded focus:ring-green-500 border-gray-300"
          />
          <span className="text-sm text-gray-700 font-medium">Producto Activo</span>
        </label>
      </div>

      {/* Botones de Acción */}
      <div className="flex gap-3 pt-4 border-t border-gray-100">
        <button
          type="button"
          onClick={onCancel}
          className="flex-1 px-6 py-2.5 border border-gray-300 rounded-xl hover:bg-gray-50 font-medium transition-colors text-gray-600"
        >
          Cancelar
        </button>
        <button
          type="submit"
          disabled={loading}
          className="flex-1 px-6 py-2.5 bg-primary text-white rounded-xl hover:bg-primary-dark disabled:opacity-50 font-bold transition-all shadow-md active:scale-95"
        >
          {loading ? 'Guardando...' : product ? 'Guardar Cambios' : 'Crear Producto'}
        </button>
      </div>
    </form>
  );
}

========== FILE: ./components/admin/ScheduleEditor.tsx ==========
import { useState, useEffect } from 'react';
import type { WeeklySchedule, DaySchedule } from '../../types/domain';

interface ScheduleEditorProps {
  initialSchedule: string; // JSON string from DB
  onSave: (schedule: string) => void;
}

const DAYS = [
  { key: 'monday', label: 'Lunes' },
  { key: 'tuesday', label: 'Martes' },
  { key: 'wednesday', label: 'Miércoles' },
  { key: 'thursday', label: 'Jueves' },
  { key: 'friday', label: 'Viernes' },
  { key: 'saturday', label: 'Sábado' },
  { key: 'sunday', label: 'Domingo' },
];

const DEFAULT_DAY: DaySchedule = { enabled: true, startTime: '09:00', endTime: '18:00' };

// Helper puro fuera del componente para parsear la lógica
const parseSchedule = (json: string): WeeklySchedule => {
  try {
    const parsed = json ? JSON.parse(json) : {};
    const fullSchedule: WeeklySchedule = {};
    DAYS.forEach((day) => {
      // Aseguramos que existan todos los días con defaults si faltan
      fullSchedule[day.key] = parsed[day.key] || { ...DEFAULT_DAY, enabled: false };
    });
    return fullSchedule;
  } catch (e) {
    console.error('Error parsing schedule', e);
    // Fallback seguro en caso de JSON corrupto
    const fallback: WeeklySchedule = {};
    DAYS.forEach((day) => {
        fallback[day.key] = { ...DEFAULT_DAY, enabled: false };
    });
    return fallback;
  }
};

export default function ScheduleEditor({ initialSchedule, onSave }: ScheduleEditorProps) {
  // CORRECCIÓN 1: Lazy Initialization.
  // Pasamos una función a useState. Se ejecuta solo una vez al montar.
  // Evita el doble render y el warning de useEffect.
  const [schedule, setSchedule] = useState<WeeklySchedule>(() => parseSchedule(initialSchedule));

  // Sincronizar solo si la prop cambia externamente (ej: recarga de datos)
  useEffect(() => {
    setSchedule(parseSchedule(initialSchedule));
  }, [initialSchedule]);

  // CORRECCIÓN 2: Tipado estricto en lugar de 'any'
  const handleChange = (dayKey: string, field: keyof DaySchedule, value: string | boolean) => {
    setSchedule((prev) => ({
      ...prev,
      [dayKey]: {
        ...prev[dayKey],
        [field]: value,
      },
    }));
  };

  const handleSave = () => {
    onSave(JSON.stringify(schedule));
  };

  return (
    <div className="bg-white p-6 rounded-lg shadow-md">
      <h3 className="text-lg font-semibold mb-4 text-gray-800">Horarios de Atención Semanal</h3>

      <div className="space-y-4">
        {DAYS.map((day) => (
          <div key={day.key} className="flex items-center gap-4 py-2 border-b last:border-0">
            <div className="w-32">
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={schedule[day.key]?.enabled ?? false}
                  onChange={(e) => handleChange(day.key, 'enabled', e.target.checked)}
                  className="w-4 h-4 text-primary rounded focus:ring-primary"
                />
                <span
                  className={`font-medium ${
                    schedule[day.key]?.enabled ? 'text-gray-900' : 'text-gray-400'
                  }`}
                >
                  {day.label}
                </span>
              </label>
            </div>

            <div className="flex items-center gap-2 flex-1">
              <input
                type="time"
                value={schedule[day.key]?.startTime || '09:00'}
                onChange={(e) => handleChange(day.key, 'startTime', e.target.value)}
                disabled={!schedule[day.key]?.enabled}
                className="px-3 py-1 border rounded disabled:bg-gray-100 disabled:text-gray-400"
              />
              <span className="text-gray-500">a</span>
              <input
                type="time"
                value={schedule[day.key]?.endTime || '18:00'}
                onChange={(e) => handleChange(day.key, 'endTime', e.target.value)}
                disabled={!schedule[day.key]?.enabled}
                className="px-3 py-1 border rounded disabled:bg-gray-100 disabled:text-gray-400"
              />
            </div>

            {!schedule[day.key]?.enabled && (
              <span className="text-sm text-red-400 italic">Cerrado</span>
            )}
          </div>
        ))}
      </div>

      <div className="mt-6 flex justify-end">
        <button
          onClick={handleSave}
          className="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark transition shadow-sm"
        >
          Guardar Horarios
        </button>
      </div>
    </div>
  );
}

========== FILE: ./components/admin/ServiceForm.tsx ==========
import { useState, useEffect } from 'react';
import { categoriasApi } from '../../api/categorias';
import { CategoryType } from '../../types/domain';
import type { Service, Category } from '../../types/domain';

/**
 * Service form for create/edit
 */

interface ServiceFormProps {
  service?: Service | null;
  onSubmit: (data: Partial<Service>) => Promise<void>;
  onCancel: () => void;
}

export default function ServiceForm({ service, onSubmit, onCancel }: ServiceFormProps) {
  const [categories, setCategories] = useState<Category[]>([]);
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: service?.name || '',
    description: service?.description || '',
    shortDescription: service?.shortDescription || '',
    price: service?.price || 0,
    durationMinutes: service?.durationMinutes || 60,
    categoryId: service?.categoryId || null as number | null,
    isFeatured: service?.isFeatured || false,
    isActive: service?.isActive ?? true,
    imageUrl: service?.imageUrl || '',
  });

  useEffect(() => {
    const loadCategories = async () => {
      try {
        const cats = await categoriasApi.getByType(CategoryType.SERVICE);
        setCategories(cats);
      } catch (err) {
        console.error('Error loading categories:', err);
      }
    };
    loadCategories();
  }, []);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    try {
      await onSubmit(formData);
    } finally {
      setLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1">
          Nombre del Servicio *
        </label>
        <input
          type="text"
          value={formData.name}
          onChange={(e) => setFormData({ ...formData, name: e.target.value })}
          className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
          required
        />
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1">
          Descripción Corta
        </label>
        <input
          type="text"
          value={formData.shortDescription}
          onChange={(e) => setFormData({ ...formData, shortDescription: e.target.value })}
          className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
          maxLength={100}
        />
        <p className="text-xs text-gray-500 mt-1">Máximo 100 caracteres</p>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1">
          Descripción Completa *
        </label>
        <textarea
          value={formData.description}
          onChange={(e) => setFormData({ ...formData, description: e.target.value })}
          rows={4}
          className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
          required
        />
      </div>

      <div className="grid grid-cols-2 gap-4">
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-1">Precio *</label>
          <input
            type="number"
            value={formData.price}
            onChange={(e) => { 
              const val = parseFloat(e.target.value);
              setFormData({ ...formData, price: isNaN(val) ? 0 : val })}
            }
            min="0"
            step="0.01"
            className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
            required
          />
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-700 mb-1">
            Duración (min) *
          </label>
          <input
            type="number"
            value={formData.durationMinutes}
            onChange={(e) => {
              const val = parseInt(e.target.value);
              setFormData({ ...formData, durationMinutes: isNaN(val) ? 0 : val })
            }}
            min="15"
            step="15"
            className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
            required
          />
        </div>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
        <select
          value={formData.categoryId || ''}
          onChange={(e) =>
            setFormData({ ...formData, categoryId: e.target.value ? parseInt(e.target.value) : null })
          }
          className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
        >
          <option value="">Sin categoría</option>
          {categories.map((cat) => (
            <option key={cat.id} value={cat.id}>
              {cat.name}
            </option>
          ))}
        </select>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1">URL de Imagen</label>
        <input
          type="text"
          value={formData.imageUrl}
          onChange={(e) => setFormData({ ...formData, imageUrl: e.target.value })}
          placeholder="https://ejemplo.com/imagen.jpg"
          className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
        />
      </div>

      <div className="flex items-center gap-6">
        <label className="flex items-center gap-2">
          <input
            type="checkbox"
            checked={formData.isFeatured}
            onChange={(e) => setFormData({ ...formData, isFeatured: e.target.checked })}
            className="w-4 h-4"
          />
          <span className="text-sm text-gray-700">Destacado en homepage</span>
        </label>

        <label className="flex items-center gap-2">
          <input
            type="checkbox"
            checked={formData.isActive}
            onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}
            className="w-4 h-4"
          />
          <span className="text-sm text-gray-700">Activo</span>
        </label>
      </div>

      <div className="flex gap-3 pt-4 border-t">
        <button
          type="button"
          onClick={onCancel}
          className="flex-1 px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"
        >
          Cancelar
        </button>
        <button
          type="submit"
          disabled={loading}
          className="flex-1 px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark disabled:opacity-50"
        >
          {loading ? 'Guardando...' : service ? 'Actualizar' : 'Crear'}
        </button>
      </div>
    </form>
  );
}


========== FILE: ./components/booking/CustomerForm.tsx ==========
interface CustomerFormProps {
  name: string;
  email: string;
  whatsapp: string;
  comments: string;
  onNameChange: (name: string) => void;
  onEmailChange: (email: string) => void;
  onWhatsappChange: (whatsapp: string) => void;
  onCommentsChange: (comments: string) => void;
}

export default function CustomerForm({
  name,
  email,
  whatsapp,
  comments,
  onNameChange,
  onEmailChange,
  onWhatsappChange,
  onCommentsChange,
}: CustomerFormProps) {
  
  const inputClass = "w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all placeholder:text-gray-300";

  return (
    <div className="space-y-4">
      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1 pl-1">
          Nombre completo <span className="text-accent">*</span>
        </label>
        <input
          type="text"
          value={name}
          onChange={(e) => onNameChange(e.target.value)}
          placeholder="Ej: Ana García"
          className={inputClass}
          required
        />
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-1 pl-1">
            Email <span className="text-accent">*</span>
          </label>
          <input
            type="email"
            value={email}
            onChange={(e) => onEmailChange(e.target.value)}
            placeholder="ana@ejemplo.com"
            className={inputClass}
            required
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-1 pl-1">
            WhatsApp <span className="text-accent">*</span>
          </label>
          <input
            type="tel"
            value={whatsapp}
            onChange={(e) => onWhatsappChange(e.target.value)}
            placeholder="11 5555 6666"
            className={inputClass}
            required
          />
        </div>
      </div>

      <div>
        <label className="block text-sm font-medium text-gray-700 mb-1 pl-1">
          Comentarios adicionales
        </label>
        <textarea
          value={comments}
          onChange={(e) => onCommentsChange(e.target.value)}
          placeholder="¿Alguna alergia o consulta específica?"
          rows={3}
          className={inputClass}
        />
      </div>
    </div>
  );
}

========== FILE: ./components/booking/DateTimePicker.tsx ==========
import { useState, useEffect } from 'react';
import { turnosApi } from '../../api/turnos'; // Importar API

interface DateTimePickerProps {
  serviceId: number; // <--- NUEVO PROP OBLIGATORIO
  date: string; 
  time: string;
  onDateChange: (date: string) => void;
  onTimeChange: (time: string) => void;
}

export default function DateTimePicker({
  serviceId,
  date,
  time,
  onDateChange,
  onTimeChange,
}: DateTimePickerProps) {
  const [viewDate, setViewDate] = useState(new Date());
  
  // Estado para los slots dinámicos
  const [availableSlots, setAvailableSlots] = useState<string[]>([]);
  const [loadingSlots, setLoadingSlots] = useState(false);
  const [errorSlots, setErrorSlots] = useState<string | null>(null);

  const today = new Date();
  today.setHours(0, 0, 0, 0);

  const months = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
  const daysOfWeek = ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"];

  // EFECTO: Cargar horarios cuando cambia la fecha o el servicio
  useEffect(() => {
    const fetchSlots = async () => {
      // Solo buscar si hay fecha seleccionada y servicio
      if (!date || !serviceId) {
        setAvailableSlots([]);
        return;
      }

      setLoadingSlots(true);
      setErrorSlots(null);
      
      // Limpiamos la selección de hora anterior
      // Esto es crucial para que si cambio de servicio (con mismo día) o de día, se borre la hora vieja
      onTimeChange(''); 

      try {
        const slots = await turnosApi.getAvailability(serviceId, date);
        setAvailableSlots(slots);
      } catch (err) {
        console.error("Error fetching availability:", err);
        setErrorSlots("No se pudieron cargar los horarios.");
        setAvailableSlots([]);
      } finally {
        setLoadingSlots(false);
      }
    };

    fetchSlots();
  }, [date, serviceId, onTimeChange]);// Dependencias: si cambia fecha o ID, recargar.

  // ... (Mantener lógica de calendario getDaysInMonth, handlePrevMonth, handleNextMonth igual que antes)
  
  const getDaysInMonth = (year: number, month: number) => new Date(year, month + 1, 0).getDate();
  const getFirstDayOfMonth = (year: number, month: number) => new Date(year, month, 1).getDay();

  const currentYear = viewDate.getFullYear();
  const currentMonth = viewDate.getMonth();
  const daysInMonth = getDaysInMonth(currentYear, currentMonth);
  const firstDay = getFirstDayOfMonth(currentYear, currentMonth);

  const handlePrevMonth = () => {
    const newDate = new Date(viewDate.setMonth(viewDate.getMonth() - 1));
    if (newDate.getMonth() < today.getMonth() && newDate.getFullYear() === today.getFullYear()) return;
    setViewDate(new Date(newDate));
  };

  const handleNextMonth = () => {
    setViewDate(new Date(viewDate.setMonth(viewDate.getMonth() + 1)));
  };

  const handleDayClick = (day: number) => {
    const selected = new Date(currentYear, currentMonth, day);
    const year = selected.getFullYear();
    const month = String(selected.getMonth() + 1).padStart(2, '0');
    const dayStr = String(selected.getDate()).padStart(2, '0');
    const dateString = `${year}-${month}-${dayStr}`;
    
    onDateChange(dateString);
    // El useEffect se encargará de cargar los horarios y limpiar la hora seleccionada
  };

  const emptyDays = Array(firstDay).fill(null);
  const days = Array.from({ length: daysInMonth }, (_, i) => i + 1);

  return (
    <div className="space-y-8">
      {/* ... (Render del Calendario se mantiene IGUAL que tu versión anterior) ... */}
      <div className="bg-gray-50/50 p-6 rounded-3xl border border-gray-100">
        <div className="flex items-center justify-between mb-6">
          <button type="button" onClick={handlePrevMonth} className="p-2 hover:bg-white rounded-full text-gray-500 hover:text-accent disabled:opacity-30">
            ←
          </button>
          <h3 className="font-serif text-lg font-bold text-primary capitalize">
            {months[currentMonth]} <span className="text-gray-400 font-sans font-normal">{currentYear}</span>
          </h3>
          <button type="button" onClick={handleNextMonth} className="p-2 hover:bg-white rounded-full text-gray-500 hover:text-accent">
            →
          </button>
        </div>
        <div className="grid grid-cols-7 gap-1 mb-2 text-center">
            {daysOfWeek.map(d => <div key={d} className="text-xs font-bold text-gray-400 uppercase py-2">{d}</div>)}
        </div>
        <div className="grid grid-cols-7 gap-1">
          {emptyDays.map((_, i) => <div key={`empty-${i}`} />)}
          {days.map(day => {
            const dateToCheck = new Date(currentYear, currentMonth, day);
            dateToCheck.setHours(0,0,0,0);
            const isToday = dateToCheck.getTime() === today.getTime();
            const isPast = dateToCheck < today;
            const isSelected = date === `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

            return (
              <button
                key={day}
                type="button"
                disabled={isPast}
                onClick={() => handleDayClick(day)}
                className={`
                  aspect-square rounded-full flex items-center justify-center text-sm font-medium transition-all duration-200 relative
                  ${isSelected ? 'bg-accent text-white shadow-md scale-105 font-bold' : isPast ? 'text-gray-300 cursor-not-allowed' : 'text-gray-700 hover:bg-white hover:text-accent'}
                  ${isToday && !isSelected ? 'ring-1 ring-accent text-accent' : ''}
                `}
              >
                {day}
              </button>
            );
          })}
        </div>
      </div>

      {/* --- SELECCIÓN DE HORA (DINÁMICA) --- */}
      {date ? (
        <div className="animate-fade-in">
          <label className="block text-sm font-medium text-gray-700 mb-4 pl-1">
            Horarios disponibles para el <span className="text-accent font-bold">{date.split('-').reverse().join('/')}</span>
          </label>
          
          {loadingSlots ? (
            <div className="flex justify-center py-8">
              <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-accent"></div>
            </div>
          ) : errorSlots ? (
             <div className="text-center py-4 text-red-400 text-sm bg-red-50 rounded-xl border border-red-100">
               {errorSlots}
             </div>
          ) : availableSlots.length === 0 ? (
            <div className="text-center py-6 bg-gray-50 rounded-xl border border-dashed border-gray-200 text-gray-500 text-sm">
              No hay turnos disponibles para esta fecha. Intenta otro día.
            </div>
          ) : (
            <div className="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3">
              {availableSlots.map((slot) => (
                <button
                  key={slot}
                  type="button"
                  onClick={() => onTimeChange(slot)} // El slot viene del backend como "09:00:00" o "09:00"
                  className={`py-2 px-3 rounded-xl text-sm font-medium transition-all duration-200 border ${
                    time === slot
                      ? 'bg-primary text-white border-primary shadow-lg transform -translate-y-0.5'
                      : 'bg-white text-gray-600 border-gray-100 hover:border-accent hover:text-accent hover:shadow-sm'
                  }`}
                >
                  {slot.slice(0, 5)} {/* Aseguramos formato HH:mm visualmente */}
                </button>
              ))}
            </div>
          )}
        </div>
      ) : (
        <div className="text-center py-8 bg-gray-50 rounded-2xl border border-dashed border-gray-200">
          <p className="text-gray-400 text-sm">Seleccioná un día en el calendario para ver los horarios.</p>
        </div>
      )}
    </div>
  );
}

========== FILE: ./components/booking/TurnoFlow.tsx ==========
import { useState, useEffect } from 'react';
import { turnosApi } from '../../api/turnos';
import { serviciosApi } from '../../api/servicios'; // Importamos api de servicios
import DateTimePicker from './DateTimePicker';
import CustomerForm from './CustomerForm';
import type { CreateBookingRequest, Service } from '../../types/domain';

interface TurnoFlowProps {
  service?: Service | null; // Ahora es opcional
}

export default function TurnoFlow({ service: initialService }: TurnoFlowProps) {
  const [selectedService, setSelectedService] = useState<Service | null>(initialService || null);
  const [servicesList, setServicesList] = useState<Service[]>([]);
  
  // Si no hay servicio inicial, empezamos en paso 0 (Selección), si hay, en paso 1 (Fecha)
  const [step, setStep] = useState(initialService ? 1 : 0);
  
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // Form State
  const [bookingDate, setBookingDate] = useState('');
  const [bookingTime, setBookingTime] = useState('');
  const [customerName, setCustomerName] = useState('');
  const [customerEmail, setCustomerEmail] = useState('');
  const [customerWhatsapp, setCustomerWhatsapp] = useState('');
  const [customerComments, setCustomerComments] = useState('');

  // Cargar servicios si no viene uno pre-seleccionado
  useEffect(() => {
    if (!initialService) {
      const fetchServices = async () => {
        try {
          const data = await serviciosApi.getAll();
          setServicesList(data.filter(s => s.isActive));
        } catch (err) {
          console.error(err);
          setError('No se pudieron cargar los servicios.');
        }
      };
      fetchServices();
    }
  }, [initialService]);

  const handleSelectService = (s: Service) => {
    setSelectedService(s);
    setStep(1);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleNextStep = (e: React.FormEvent) => {
    e.preventDefault();
    if (step === 1 && bookingDate && bookingTime) {
      setStep(2);
      setError(null);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!selectedService) return;

    setError(null);
    setLoading(true);

    try {
      const bookingRequest: CreateBookingRequest = {
        serviceId: selectedService.id,
        customerName,
        customerEmail,
        customerWhatsapp,
        customerComments: customerComments || null,
        bookingDate,
        bookingTime,
        durationMinutes: selectedService.durationMinutes, 
        amount: selectedService.price, 
      };

      const booking = await turnosApi.create(bookingRequest);
      const paymentPreference = await turnosApi.createPaymentPreference(booking.id);
      window.location.href = paymentPreference.initPoint;
      
    } catch (err: unknown) {
      console.error(err);
      const errorMessage = err instanceof Error ? err.message : 'Error al procesar la reserva';
      setError(errorMessage);
      setLoading(false);
    }
  };

  return (
    <div className="max-w-6xl mx-auto grid lg:grid-cols-12 gap-8 items-start">
      
      {/* COLUMNA IZQUIERDA: Resumen (Solo aparece si ya elegimos servicio) */}
      {selectedService && (
        <div className="lg:col-span-4 lg:sticky lg:top-24 animate-fade-in">
          <div className="bg-white rounded-3xl p-6 shadow-soft border border-gray-50 overflow-hidden">
             {/* Botón cambiar servicio si estamos en el flujo genérico */}
             {!initialService && step > 0 && (
              <button 
                onClick={() => { setStep(0); setSelectedService(null); }}
                className="text-xs text-accent font-bold uppercase tracking-wider mb-4 hover:underline"
              >
                ← Cambiar Servicio
              </button>
            )}

            <div className="relative h-48 -mx-6 -mt-6 mb-6">
              <img 
                src={selectedService.imageUrl || '/placeholder-service.jpg'} 
                alt={selectedService.name}
                className="w-full h-full object-cover"
                onError={(e) => (e.currentTarget.src = 'https://placehold.co/400x300/F9F7F5/E5989B?text=Servicio')}
              />
              <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent flex items-end p-6">
                 <span className="text-white font-bold text-lg">${selectedService.price}</span>
              </div>
            </div>
            
            <h2 className="font-serif text-2xl font-bold text-primary mb-2">{selectedService.name}</h2>
            <div className="flex items-center gap-2 text-sm text-gray-500 mb-4">
              <span className="bg-gray-100 px-2 py-1 rounded-md">⏱ {selectedService.durationMinutes} min</span>
            </div>
            <p className="text-gray-500 text-sm leading-relaxed">
              {selectedService.shortDescription || selectedService.description}
            </p>
          </div>
        </div>
      )}

      {/* COLUMNA DERECHA: Wizard */}
      <div className={`${selectedService ? 'lg:col-span-8' : 'lg:col-span-12'}`}>
        <div className="bg-white rounded-3xl shadow-soft p-8 border border-gray-50">
          
          {/* PASO 0: SELECCIÓN DE SERVICIO */}
          {step === 0 && (
            <div className="animate-fade-in">
              <h1 className="font-serif text-3xl font-bold text-primary mb-2 text-center">Reservar Turno</h1>
              <p className="text-gray-500 text-center mb-8">Seleccioná el tratamiento que deseas realizar.</p>
              
              <div className="grid md:grid-cols-2 gap-4">
                {servicesList.map(s => (
                  <button
                    key={s.id}
                    onClick={() => handleSelectService(s)}
                    className="flex items-center gap-4 p-4 rounded-2xl border border-gray-100 hover:border-accent hover:shadow-md transition-all text-left group"
                  >
                    <div className="w-16 h-16 rounded-xl bg-gray-50 overflow-hidden flex-shrink-0">
                      <img src={s.imageUrl || ''} alt="" className="w-full h-full object-cover" onError={(e) => e.currentTarget.style.display = 'none'} />
                    </div>
                    <div>
                      <h3 className="font-sans font-bold text-primary group-hover:text-accent transition-colors">{s.name}</h3>
                      <div className="flex gap-3 text-xs text-gray-500 mt-1">
                        <span>${s.price}</span>
                        <span>•</span>
                        <span>{s.durationMinutes} min</span>
                      </div>
                    </div>
                  </button>
                ))}
              </div>
            </div>
          )}

          {/* PASOS 1 y 2 (Igual que antes) */}
          {step > 0 && (
            <>
              {/* Indicador de Pasos */}
              <div className="flex items-center justify-between mb-8 text-sm font-medium">
                <div className={`flex items-center gap-2 ${step >= 1 ? 'text-accent' : 'text-gray-300'}`}>
                  <span className={`w-8 h-8 rounded-full flex items-center justify-center border-2 ${step >= 1 ? 'border-accent bg-accent text-white' : 'border-gray-200'}`}>1</span>
                  <span>Fecha</span>
                </div>
                <div className={`h-px bg-gray-200 flex-1 mx-4`}></div>
                <div className={`flex items-center gap-2 ${step >= 2 ? 'text-accent' : 'text-gray-300'}`}>
                  <span className={`w-8 h-8 rounded-full flex items-center justify-center border-2 ${step >= 2 ? 'border-accent bg-accent text-white' : 'border-gray-200'}`}>2</span>
                  <span>Datos</span>
                </div>
              </div>

              <form onSubmit={step === 1 ? handleNextStep : handleSubmit}>
                {step === 1 && (
                  <div className="animate-fade-in">
                    <h3 className="font-serif text-xl font-bold text-primary mb-6">Agenda tu cita</h3>
                    <DateTimePicker
                      serviceId={selectedService!.id}
                      date={bookingDate}
                      time={bookingTime}
                      onDateChange={setBookingDate}
                      onTimeChange={setBookingTime}
                    />
                  </div>
                )}

                {step === 2 && (
                  <div className="animate-fade-in">
                    <h3 className="font-serif text-xl font-bold text-primary mb-6">Tus datos</h3>
                    <CustomerForm
                      name={customerName}
                      email={customerEmail}
                      whatsapp={customerWhatsapp}
                      comments={customerComments}
                      onNameChange={setCustomerName}
                      onEmailChange={setCustomerEmail}
                      onWhatsappChange={setCustomerWhatsapp}
                      onCommentsChange={setCustomerComments}
                    />
                  </div>
                )}

                {error && (
                  <div className="mt-6 p-4 rounded-xl bg-red-50 text-red-500 text-sm border border-red-100">{error}</div>
                )}

                <div className="mt-8 pt-6 border-t border-gray-100 flex gap-4">
                  <button
                    type="button"
                    onClick={() => step === 1 ? (initialService ? null : setStep(0)) : setStep(1)}
                    className={`px-6 py-3 rounded-xl font-medium text-gray-500 hover:bg-gray-50 transition-colors ${step === 1 && initialService ? 'hidden' : ''}`}
                  >
                    Volver
                  </button>
                  
                  <button
                    type="submit"
                    disabled={loading || (step === 1 && (!bookingDate || !bookingTime))}
                    className="flex-1 bg-primary text-white py-4 rounded-xl font-bold text-lg hover:bg-accent transition-all shadow-lg disabled:opacity-50"
                  >
                    {loading ? 'Procesando...' : step === 1 ? 'Continuar' : 'Confirmar Reserva'}
                  </button>
                </div>
              </form>
            </>
          )}

        </div>
      </div>
    </div>
  );
}

========== FILE: ./components/cart/CartItemComponent.tsx ==========
import { useCart } from '../../context/CartContext';
import type { CartItem } from '../../types/domain';

/**
 * Cart item component
 * Displays product in cart with quantity controls and remove button
 */

interface CartItemProps {
  item: CartItem;
}

export default function CartItemComponent({ item }: CartItemProps) {
  const { updateQuantity, removeItem } = useCart();

  const handleQuantityChange = (newQuantity: number) => {
    if (newQuantity > 0 && newQuantity <= item.product.stock) {
      updateQuantity(item.product.id, newQuantity);
    }
  };

  const handleRemove = () => {
    removeItem(item.product.id);
  };

  const subtotal = item.product.price * item.quantity;

  return (
    <div className="flex gap-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200">
      {/* Product Image */}
      <div className="w-24 h-24 flex-shrink-0">
        <img
          src={item.product.imageUrl || '/placeholder-product.jpg'}
          alt={item.product.name}
          className="w-full h-full object-cover rounded"
          onError={(e) => {
            (e.target as HTMLImageElement).src = '/placeholder-product.jpg';
          }}
        />
      </div>

      {/* Product Info */}
      <div className="flex-grow">
        <h3 className="font-semibold text-gray-800">{item.product.name}</h3>
        <p className="text-sm text-gray-600 mt-1">
          ${item.product.price} c/u
        </p>
        <p className="text-xs text-gray-500 mt-1">
          Stock disponible: {item.product.stock}
        </p>
      </div>

      {/* Quantity Controls */}
      <div className="flex flex-col items-center justify-center gap-2">
        <div className="flex items-center gap-2">
          <button
            onClick={() => handleQuantityChange(item.quantity - 1)}
            disabled={item.quantity <= 1}
            className="w-8 h-8 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            -
          </button>
          <span className="w-12 text-center font-semibold">{item.quantity}</span>
          <button
            onClick={() => handleQuantityChange(item.quantity + 1)}
            disabled={item.quantity >= item.product.stock}
            className="w-8 h-8 flex items-center justify-center bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            +
          </button>
        </div>
        <button
          onClick={handleRemove}
          className="text-sm text-red-600 hover:text-red-700"
        >
          Eliminar
        </button>
      </div>

      {/* Subtotal */}
      <div className="flex items-center justify-center w-24">
        <span className="font-bold text-primary">${subtotal}</span>
      </div>
    </div>
  );
}


========== FILE: ./components/cart/CartSummary.tsx ==========
/**
 * Cart summary component
 * Shows subtotal, delivery cost, and total
 */

interface CartSummaryProps {
  subtotal: number;
  deliveryCost: number;
}

export default function CartSummary({ subtotal, deliveryCost }: CartSummaryProps) {
  const total = subtotal + deliveryCost;

  return (
    <div className="bg-white p-6 rounded-lg shadow-md border border-gray-200">
      <h3 className="text-xl font-semibold mb-4">Resumen del Pedido</h3>

      <div className="space-y-3">
        <div className="flex justify-between text-gray-700">
          <span>Subtotal:</span>
          <span>${subtotal}</span>
        </div>
        <div className="flex justify-between text-gray-700">
          <span>Envío:</span>
          <span>{deliveryCost === 0 ? 'Gratis' : `$${deliveryCost}`}</span>
        </div>
        <div className="border-t pt-3 flex justify-between text-lg font-bold text-primary">
          <span>Total:</span>
          <span>${total}</span>
        </div>
      </div>
    </div>
  );
}


========== FILE: ./components/cart/DeliverySelector.tsx ==========
import { DeliveryType } from '../../types/domain';

/**
 * Delivery type selector
 * Radio buttons for PICKUP or HOME_DELIVERY with address fields
 */

interface DeliverySelectorProps {
  deliveryType: string;
  onDeliveryTypeChange: (type: string) => void;
  address: string;
  city: string;
  province: string;
  postalCode: string;
  onAddressChange: (field: string, value: string) => void;
  deliveryCost: number;
}

export default function DeliverySelector({
  deliveryType,
  onDeliveryTypeChange,
  address,
  city,
  province,
  postalCode,
  onAddressChange,
  deliveryCost,
}: DeliverySelectorProps) {
  return (
    <div className="space-y-4">
      <h3 className="font-semibold text-gray-800">Tipo de Entrega</h3>

      {/* Pickup Option */}
      <label className="flex items-start gap-3 p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
        <input
          type="radio"
          name="deliveryType"
          value={DeliveryType.PICKUP}
          checked={deliveryType === DeliveryType.PICKUP}
          onChange={(e) => onDeliveryTypeChange(e.target.value)}
          className="mt-1"
        />
        <div className="flex-grow">
          <div className="font-semibold text-gray-800">Retiro en local</div>
          <div className="text-sm text-gray-600 mt-1">
            Retirá tu pedido personalmente. Gratis.
          </div>
        </div>
      </label>

      {/* Home Delivery Option */}
      <label className="flex items-start gap-3 p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
        <input
          type="radio"
          name="deliveryType"
          value={DeliveryType.HOME_DELIVERY}
          checked={deliveryType === DeliveryType.HOME_DELIVERY}
          onChange={(e) => onDeliveryTypeChange(e.target.value)}
          className="mt-1"
        />
        <div className="flex-grow">
          <div className="font-semibold text-gray-800">Envío a domicilio</div>
          <div className="text-sm text-gray-600 mt-1">
            Recibí tu pedido en tu casa. Costo: ${deliveryCost}
          </div>
        </div>
      </label>

      {/* Address Fields (shown only for HOME_DELIVERY) */}
      {deliveryType === DeliveryType.HOME_DELIVERY && (
        <div className="pl-8 space-y-3 mt-4">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Dirección *
            </label>
            <input
              type="text"
              value={address}
              onChange={(e) => onAddressChange('address', e.target.value)}
              placeholder="Calle y número"
              className="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
              required
            />
          </div>
          <div className="grid grid-cols-2 gap-3">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Ciudad *
              </label>
              <input
                type="text"
                value={city}
                onChange={(e) => onAddressChange('city', e.target.value)}
                placeholder="Ciudad"
                className="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                required
              />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Provincia *
              </label>
              <input
                type="text"
                value={province}
                onChange={(e) => onAddressChange('province', e.target.value)}
                placeholder="Provincia"
                className="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
                required
              />
            </div>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Código Postal *
            </label>
            <input
              type="text"
              value={postalCode}
              onChange={(e) => onAddressChange('postalCode', e.target.value)}
              placeholder="Código postal"
              className="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"
              required
            />
          </div>
        </div>
      )}
    </div>
  );
}


========== FILE: ./components/catalog/CategoryFilter.tsx ==========
import type { Category } from '../../types/domain';

/**
 * Category filter component
 * Shows category buttons to filter items
 */

interface CategoryFilterProps {
  categories: Category[];
  selectedCategoryId: number | null;
  onSelectCategory: (categoryId: number | null) => void;
}

export default function CategoryFilter({
  categories,
  selectedCategoryId,
  onSelectCategory,
}: CategoryFilterProps) {
  return (
    <div className="flex flex-wrap gap-3 justify-center mb-8">
      <button
        onClick={() => onSelectCategory(null)}
        className={`px-6 py-2 rounded-full font-semibold transition ${
          selectedCategoryId === null
            ? 'bg-primary text-white'
            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
        }`}
      >
        Todos
      </button>
      {categories.map((category) => (
        <button
          key={category.id}
          onClick={() => onSelectCategory(category.id)}
          className={`px-6 py-2 rounded-full font-semibold transition ${
            selectedCategoryId === category.id
              ? 'bg-primary text-white'
              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
          }`}
        >
          {category.name}
        </button>
      ))}
    </div>
  );
}


========== FILE: ./components/catalog/ProductoCard.tsx ==========
import { Link } from 'react-router-dom';
import { useCart } from '../../context/CartContext';
import type { Product } from '../../types/domain';

interface ProductoCardProps {
  product: Product;
}

export default function ProductoCard({ product }: ProductoCardProps) {
  const { items, addItem, updateQuantity, removeItem } = useCart();
  
  // Buscamos si este producto ya está en el carrito
  const cartItem = items.find((item) => item.product.id === product.id);
  const quantityInCart = cartItem ? cartItem.quantity : 0;
  const hasStock = product.stock > 0;

  // Lógica de botones
  const handleAdd = () => {
    if (hasStock) addItem(product, 1);
  };

  const handleIncrement = () => {
    if (quantityInCart < product.stock) {
      updateQuantity(product.id, quantityInCart + 1);
    }
  };

  const handleDecrement = () => {
    if (quantityInCart === 1) {
      removeItem(product.id);
    } else {
      updateQuantity(product.id, quantityInCart - 1);
    }
  };

  return (
    <div className={`group bg-white rounded-3xl p-4 transition-all duration-300 hover:shadow-soft border border-transparent hover:border-gray-50 flex flex-col h-full ${!hasStock ? 'opacity-70' : ''}`}>
      
      {/* 1. IMAGEN */}
      <div className="relative aspect-square rounded-2xl overflow-hidden bg-gray-50 mb-4">
        {product.isOffer && hasStock && (
          <span className="absolute top-3 left-3 bg-accent text-white text-[10px] font-bold px-3 py-1 rounded-full z-10 shadow-sm tracking-wider">
            OFERTA
          </span>
        )}

        {!hasStock && (
          <div className="absolute inset-0 bg-white/60 backdrop-blur-[2px] flex items-center justify-center z-20">
            <span className="bg-primary text-white text-xs font-bold px-4 py-2 rounded-full shadow-md">
              SIN STOCK
            </span>
          </div>
        )}

        <img
          src={product.imageUrl || '/placeholder.jpg'}
          alt={product.name}
          className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
          onError={(e) => (e.currentTarget.src = 'https://placehold.co/400x400/F9F7F5/E5989B?text=Producto')}
        />
      </div>

      {/* 2. INFO */}
      <div className="flex-grow flex flex-col">
        <div className="mb-3">
          <p className="text-xs text-gray-400 font-medium mb-1 uppercase tracking-wide">
            {product.categoryName}
          </p>
          <h3 className="font-sans font-bold text-lg text-primary leading-tight group-hover:text-accent transition-colors line-clamp-2" title={product.name}>
            <Link to={`/productos/${product.slug}`}>{product.name}</Link>
          </h3>
        </div>

        {/* 3. PRECIO Y ACCIÓN (Sticky Bottom) */}
        <div className="mt-auto pt-2 flex items-center justify-between gap-3">
          <span className="font-sans font-bold text-xl text-primary">
            ${product.price}
          </span>

          {/* ZONA DE ACCIÓN: Aquí ocurre la magia */}
          {quantityInCart > 0 ? (
            // ESTADO: EN CARRITO (Contador)
            <div className="flex items-center bg-primary text-white rounded-full px-1 py-1 h-10 shadow-md animate-fade-in">
              <button 
                onClick={handleDecrement}
                className="w-8 h-full flex items-center justify-center hover:text-accent transition-colors active:scale-90"
              >
                −
              </button>
              <span className="font-bold text-sm w-4 text-center select-none">
                {quantityInCart}
              </span>
              <button 
                onClick={handleIncrement}
                disabled={quantityInCart >= product.stock}
                className={`w-8 h-full flex items-center justify-center transition-colors active:scale-90 ${quantityInCart >= product.stock ? 'opacity-50 cursor-not-allowed' : 'hover:text-accent'}`}
              >
                +
              </button>
            </div>
          ) : (
            // ESTADO: NO AGREGADO (Botón simple)
            <button
              onClick={handleAdd}
              disabled={!hasStock}
              className={`h-10 px-5 rounded-full text-xs font-bold tracking-wide transition-all duration-300 shadow-sm hover:shadow-md active:scale-95 ${
                hasStock 
                  ? 'bg-white text-primary border border-gray-200 hover:border-accent hover:bg-accent hover:text-white' 
                  : 'bg-gray-100 text-gray-300 cursor-not-allowed border border-transparent'
              }`}
            >
              AGREGAR
            </button>
          )}
        </div>
      </div>
    </div>
  );
}

========== FILE: ./components/catalog/ServicioCard.tsx ==========
import { Link } from 'react-router-dom';
import type { Service } from '../../types/domain';

/**
 * Service card component
 * Displays service info with link to booking
 */

interface ServicioCardProps {
  service: Service;
}

export default function ServicioCard({ service }: ServicioCardProps) {
  const imageUrl = service.imageUrl || '/placeholder-service.jpg';

  return (
    <div className="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition">
      <img
        src={imageUrl}
        alt={service.name}
        className="w-full h-48 object-cover"
        onError={(e) => {
          (e.target as HTMLImageElement).src = '/placeholder-service.jpg';
        }}
      />
      <div className="p-6">
        <h3 className="text-xl font-semibold text-gray-800 mb-2">{service.name}</h3>
        <p className="text-gray-600 mb-4 line-clamp-2">
          {service.shortDescription || service.description}
        </p>
        <div className="flex items-center justify-between">
          <div>
            <span className="text-2xl font-bold text-primary">${service.price}</span>
            <span className="text-gray-500 text-sm ml-2">· {service.durationMinutes} min</span>
          </div>
        </div>
        <Link
          to={`/servicios/${service.slug}/reservar`}
          className="mt-4 block w-full bg-primary text-white text-center py-2 rounded-lg hover:bg-primary-dark transition"
        >
          Reservar Turno
        </Link>
      </div>
    </div>
  );
}


========== FILE: ./components/common/Navbar.tsx ==========
import { useState } from 'react';
import { Link, NavLink } from 'react-router-dom';
import { useCart } from '../../context/CartContext';

export default function Navbar() {
  const { itemCount } = useCart();
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

  // Estilos para los links: Detecta automáticamente si estás en esa página
  const navLinkClasses = ({ isActive }: { isActive: boolean }) =>
    `text-sm font-medium tracking-wide transition-colors duration-300 ${
      isActive ? 'text-accent' : 'text-primary hover:text-accent'
    }`;

  return (
    <nav className="sticky top-0 z-50 w-full bg-background/80 backdrop-blur-md border-b border-gray-100 transition-all duration-300">
      <div className="container mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex items-center justify-between h-20">
          
          {/* 1. LOGOTIPO */}
          <Link to="/" className="flex items-center gap-2 group z-50">
            {/* Isotipo Decorativo */}
            <div className="w-8 h-8 bg-primary text-white flex items-center justify-center rounded-tr-xl rounded-bl-xl group-hover:bg-accent transition-colors duration-300 shadow-sm">
              <span className="font-serif italic font-bold text-lg">F</span>
            </div>
            {/* Texto del Logo */}
            <span className="font-serif text-2xl font-bold text-primary tracking-tight group-hover:text-accent transition-colors duration-300">
              Flavia<span className="text-accent">.</span>
            </span>
          </Link>

          {/* 2. MENÚ DE ESCRITORIO (Centrado) */}
          <div className="hidden md:flex items-center gap-8">
            <NavLink to="/" className={navLinkClasses}>Inicio</NavLink>
            <NavLink to="/servicios" className={navLinkClasses}>Servicios</NavLink>
            <NavLink to="/productos" className={navLinkClasses}>Productos</NavLink>
            <NavLink to="/flavia" className={navLinkClasses}>Sobre Flavia</NavLink>
          </div>

          {/* 3. ACCIONES (Derecha) */}
          <div className="hidden md:flex items-center gap-6">
            {/* Carrito de Compras */}
            <Link 
              to="/carrito" 
              className="relative group p-2 text-primary hover:text-accent transition-colors"
              aria-label="Ver carrito"
            >
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 5c.07.286-.06.591-.292.684l-1.428.571M12 18.75a6 6 0 006-6M12 18.75a6 6 0 01-6-6m0 0V6m0 0A2.25 2.25 0 0113.5 2.25H15" />
              </svg>
              
              {itemCount > 0 && (
                <span className="absolute top-0 right-0 flex h-4 w-4 items-center justify-center rounded-full bg-accent text-[10px] font-bold text-white shadow-sm ring-2 ring-white animate-bounce">
                  {itemCount}
                </span>
              )}
            </Link>

            {/* Separador vertical */}
            <div className="h-6 w-px bg-gray-200"></div>

            {/* Botón CTA (Call to Action) */}
            <Link
              to="/reservar"
              className="bg-primary text-white px-6 py-2.5 rounded-full text-sm font-medium shadow-soft hover:shadow-lg hover:bg-accent hover:-translate-y-0.5 transition-all duration-300"
            >
              Reservar Turno
            </Link>
          </div>

          {/* 4. BOTÓN HAMBURGUESA (Móvil) */}
          <button
            onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
            className="md:hidden p-2 text-primary hover:text-accent focus:outline-none z-50"
            aria-label="Menu"
          >
            {isMobileMenuOpen ? (
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-7 h-7">
                <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
            ) : (
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-7 h-7">
                <path strokeLinecap="round" strokeLinejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5" />
              </svg>
            )}
          </button>
        </div>
      </div>

      {/* 5. MENÚ MÓVIL (Desplegable) */}
      {/* Fondo oscuro para el resto de la pantalla */}
      {isMobileMenuOpen && (
        <div 
            className="fixed inset-0 bg-black/20 backdrop-blur-sm z-40 md:hidden"
            onClick={() => setIsMobileMenuOpen(false)}
        />
      )}

      {/* Panel del menú */}
      <div 
        className={`fixed top-[80px] left-0 w-full bg-white border-b border-gray-100 shadow-xl z-40 transform transition-all duration-300 ease-in-out md:hidden ${
          isMobileMenuOpen ? 'translate-y-0 opacity-100' : '-translate-y-full opacity-0 pointer-events-none'
        }`}
      >
        <div className="flex flex-col p-6 space-y-4">
          <NavLink 
            to="/" 
            className={({isActive}) => `text-lg font-medium ${isActive ? 'text-accent' : 'text-primary'}`}
            onClick={() => setIsMobileMenuOpen(false)}
          >
            Inicio
          </NavLink>
          <NavLink 
            to="/servicios" 
            className={({isActive}) => `text-lg font-medium ${isActive ? 'text-accent' : 'text-primary'}`}
            onClick={() => setIsMobileMenuOpen(false)}
          >
            Servicios
          </NavLink>
          <NavLink 
            to="/productos" 
            className={({isActive}) => `text-lg font-medium ${isActive ? 'text-accent' : 'text-primary'}`}
            onClick={() => setIsMobileMenuOpen(false)}
          >
            Productos
          </NavLink>
          <NavLink 
            to="/flavia" 
            className={({isActive}) => `text-lg font-medium ${isActive ? 'text-accent' : 'text-primary'}`}
            onClick={() => setIsMobileMenuOpen(false)}
          >
            Sobre Flavia
          </NavLink>
          
          <div className="border-t border-gray-100 pt-4 mt-2">
            <Link 
              to="/carrito" 
              className="flex items-center justify-between text-primary py-2"
              onClick={() => setIsMobileMenuOpen(false)}
            >
              <span className="font-medium">Tu Carrito</span>
              <div className="flex items-center gap-2">
                <span className="text-sm text-gray-500">{itemCount} items</span>
                <div className="bg-accent/10 p-2 rounded-full text-accent">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5">
                        <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 5c.07.286-.06.591-.292.684l-1.428.571M12 18.75a6 6 0 006-6M12 18.75a6 6 0 01-6-6m0 0V6m0 0A2.25 2.25 0 0113.5 2.25H15" />
                    </svg>
                </div>
              </div>
            </Link>
          </div>

          <Link
            to="/reservar"
            onClick={() => setIsMobileMenuOpen(false)}
            className="mt-2 w-full bg-primary text-white text-center py-3.5 rounded-xl font-semibold shadow-lg active:scale-95 transition-transform"
          >
            Reservar Turno Ahora
          </Link>
        </div>
      </div>
    </nav>
  );
}

========== FILE: ./components/common/ScrollToTop.tsx ==========
import { useEffect } from 'react';
import { useLocation } from 'react-router-dom';

export default function ScrollToTop() {
  const { pathname } = useLocation();

  useEffect(() => {
    // Cada vez que cambia la ruta (pathname), hacemos scroll a 0,0 (arriba a la izquierda)
    window.scrollTo(0, 0);
  }, [pathname]);

  return null; // Este componente no renderiza nada visual
}

========== FILE: ./components/home/FeaturedProducts.tsx ==========
import { useEffect, useState } from 'react';
import { Link } from 'react-router-dom';
import { productosApi } from '../../api/productos';
import ProductoCard from '../catalog/ProductoCard';
import type { Product } from '../../types/domain';

export default function FeaturedProducts() {
  const [products, setProducts] = useState<Product[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const loadProducts = async () => {
      try {
        const data = await productosApi.getFeatured();
        setProducts(data.slice(0, 4));
      } catch (error) {
        console.error('Error loading featured products:', error);
      } finally {
        setLoading(false);
      }
    };
    loadProducts();
  }, []);

  if (loading) return null;
  if (products.length === 0) return null;

  return (
    <section className="py-24 bg-background relative">
      <div className="container mx-auto px-4">
        
        <div className="text-center max-w-3xl mx-auto mb-16">
          <span className="text-accent font-medium tracking-wider text-sm uppercase">Shop Online</span>
          <h2 className="font-serif text-4xl font-bold text-primary mt-2 mb-4">
            Cuidado Profesional en Casa
          </h2>
          <p className="text-gray-500 font-sans">
            Fórmulas seleccionadas para extender los resultados del consultorio.
          </p>
        </div>

        {/* Grid usando el Componente Inteligente */}
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
          {products.map((product) => (
            <ProductoCard key={product.id} product={product} />
          ))}
        </div>

        <div className="mt-16 text-center">
          <Link
            to="/productos"
            className="inline-block border-b border-primary pb-1 text-primary hover:text-accent hover:border-accent transition-colors font-medium"
          >
            Ver catálogo completo
          </Link>
        </div>
      </div>
    </section>
  );
}

========== FILE: ./components/home/FeaturedServices.tsx ==========
import { useEffect, useState } from 'react';
import { Link } from 'react-router-dom';
import { serviciosApi } from '../../api/servicios';
import type { Service } from '../../types/domain';

export default function FeaturedServices() {
  const [services, setServices] = useState<Service[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const loadServices = async () => {
      try {
        const data = await serviciosApi.getFeatured();
        setServices(data.slice(0, 3));
      } catch (error) {
        console.error('Error loading featured services:', error);
      } finally {
        setLoading(false);
      }
    };

    loadServices();
  }, []);

  if (loading) return null; // O un esqueleto de carga simple
  if (services.length === 0) return null;

  return (
    <section className="py-24 bg-white">
      <div className="container mx-auto px-4">
        
        {/* Header de Sección */}
        <div className="text-center max-w-2xl mx-auto mb-16">
          <h2 className="font-serif text-4xl font-bold text-primary mb-4">
            Tratamientos Destacados
          </h2>
          <p className="text-gray-500">
            Procedimientos no invasivos seleccionados específicamente para las necesidades de tu piel.
          </p>
        </div>

        {/* Grid de Tarjetas */}
        <div className="grid md:grid-cols-3 gap-8">
          {services.map((service) => (
            <div
              key={service.id}
              className="group relative bg-background rounded-3xl overflow-hidden hover:shadow-soft transition-all duration-300 flex flex-col"
            >
              {/* Imagen */}
              <div className="relative h-64 overflow-hidden">
                <img
                  src={service.imageUrl || 'https://images.unsplash.com/photo-1616394584738-fc6e612e71b9?auto=format&fit=crop&q=80'}
                  alt={service.name}
                  className="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-700"
                />
                <div className="absolute top-4 right-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold text-primary shadow-sm">
                  {service.durationMinutes} min
                </div>
              </div>

              {/* Contenido */}
              <div className="p-8 flex flex-col flex-grow">
                <div className="mb-4">
                  <h3 className="font-sans text-2xl font-semibold text-primary mb-2 group-hover:text-accent transition-colors">
                    {service.name}
                  </h3>
                  <p className="text-gray-500 text-sm line-clamp-2 leading-relaxed">
                    {service.shortDescription || service.description}
                  </p>
                </div>

                <div className="mt-auto pt-6 border-t border-gray-100 flex items-center justify-between">
                  <span className="font-sans font-bold text-xl text-primary">
                    ${service.price}
                  </span>
                  
                  <Link
                    to={`/servicios/${service.slug}/reservar`}
                    className="text-sm font-semibold text-primary border-b-2 border-accent/30 hover:border-accent transition-colors pb-0.5"
                  >
                    Agendar Cita
                  </Link>
                </div>
              </div>
            </div>
          ))}
        </div>

        <div className="mt-16 text-center">
          <Link
            to="/servicios"
            className="inline-flex items-center gap-2 text-gray-500 hover:text-accent transition-colors font-medium"
          >
            Ver todos los tratamientos
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-4 h-4">
              <path strokeLinecap="round" strokeLinejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
          </Link>
        </div>

      </div>
    </section>
  );
}

========== FILE: ./components/home/HeroSection.tsx ==========
import { Link } from 'react-router-dom';

export default function HeroSection() {
  return (
    <section className="relative bg-background overflow-hidden pt-12 pb-20 lg:pt-24 lg:pb-32">
      <div className="container mx-auto px-4 sm:px-6 lg:px-8">
        <div className="grid lg:grid-cols-2 gap-12 lg:gap-8 items-center">
          
          {/* COLUMNA IZQUIERDA: Texto */}
          <div className="max-w-2xl text-center lg:text-left z-10">
            <span className="inline-block py-1 px-3 rounded-full bg-accent/10 text-accent text-sm font-semibold tracking-wide mb-6">
              Dermocosmiatría Clínica
            </span>
            
            <h1 className="font-serif text-5xl lg:text-7xl font-bold text-primary leading-[1.1] mb-6">
              Descubrí la mejor <br/>
              <span className="text-transparent bg-clip-text bg-gradient-to-r from-accent to-pink-400">
                versión de tu piel
              </span>
            </h1>
            
            <p className="text-lg text-gray-600 mb-8 leading-relaxed max-w-lg mx-auto lg:mx-0 font-sans">
              Tratamientos faciales y corporales personalizados, diseñados para realzar tu belleza natural con ciencia y dedicación.
            </p>
            
            <div className="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
              <Link
                to="/servicios"
                className="bg-primary text-white px-8 py-4 rounded-full font-medium shadow-lg hover:bg-accent hover:shadow-xl hover:-translate-y-1 transition-all duration-300"
              >
                Reservar Turno
              </Link>
              <Link
                to="/productos"
                className="bg-white text-primary border border-gray-200 px-8 py-4 rounded-full font-medium hover:border-accent hover:text-accent transition-all duration-300"
              >
                Ver Productos
              </Link>
            </div>

            {/* Social Proof (Pequeño detalle de confianza) */}
            <div className="mt-10 flex items-center justify-center lg:justify-start gap-4 text-sm text-gray-500">
              <div className="flex -space-x-2">
                {[1, 2, 3].map((i) => (
                  <div key={i} className="w-8 h-8 rounded-full bg-gray-200 border-2 border-white" />
                ))}
              </div>
              <p>+500 clientas felices</p>
            </div>
          </div>

          {/* COLUMNA DERECHA: Imagen */}
          <div className="relative lg:h-[600px] flex items-center justify-center">
            {/* Círculo decorativo de fondo */}
            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120%] h-[120%] bg-white/40 rounded-full blur-3xl -z-10"></div>
            
            {/* Imagen Principal con forma orgánica */}
            <div className="relative w-full max-w-md lg:max-w-full aspect-[4/5] rounded-[3rem] overflow-hidden shadow-2xl rotate-2 hover:rotate-0 transition-transform duration-700 ease-out">
              <img 
                src="https://images.unsplash.com/photo-1570172619644-dfd03ed5d881?q=80&w=2070&auto=format&fit=crop" 
                alt="Tratamiento facial" 
                className="w-full h-full object-cover"
              />
              
              {/* Badge Flotante */}
              <div className="absolute bottom-8 left-8 bg-white/90 backdrop-blur p-4 rounded-2xl shadow-lg max-w-[200px]">
                <p className="font-serif font-bold text-lg text-primary">Skin Glow</p>
                <p className="text-xs text-gray-500">Tratamiento estrella para luminosidad inmediata.</p>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>
  );
}

========== FILE: ./components/home/MiniBio.tsx ==========
import { Link } from 'react-router-dom';
import fotoFlavia from '../../assets/flavia.jpg'

export default function MiniBio() {
  return (
    <section className="py-24 bg-accent/5 relative overflow-hidden">
      {/* Elemento decorativo de fondo */}
      <div className="absolute top-0 right-0 -mr-20 -mt-20 w-96 h-96 bg-accent/10 rounded-full blur-3xl"></div>

      <div className="container mx-auto px-4 relative z-10">
        <div className="flex flex-col md:flex-row items-center gap-12 lg:gap-20">
          
          {/* Columna Imagen */}
          <div className="w-full md:w-1/2 flex justify-center md:justify-end">
            <div className="relative w-72 h-72 lg:w-96 lg:h-96">
              <div className="absolute inset-0 border-2 border-accent/30 rounded-full transform translate-x-4 translate-y-4"></div>
              <img
                src={fotoFlavia} 
                alt="Flavia, Dermocosmiatra"
                className="w-full h-full object-cover rounded-full shadow-lg relative z-10"
              />
            </div>
          </div>

          {/* Columna Texto */}
          <div className="w-full md:w-1/2 text-center md:text-left">
            <h2 className="font-serif text-4xl lg:text-5xl font-bold text-primary mb-6">
              Hola, soy Flavia
            </h2>
            
            <div className="space-y-6 text-gray-600 leading-relaxed font-sans">
              <p>
                Especialista en dermocosmiatría con más de 10 años dedicados al cuidado integral de la piel. Mi filosofía combina la ciencia dermatológica con un enfoque holístico del bienestar.
              </p>
              <p>
                Creo firmemente que cada piel cuenta una historia única. En mi consultorio, no solo tratamos afecciones, sino que diseñamos rutinas personalizadas que se adaptan a tu estilo de vida y objetivos.
              </p>
            </div>

            <div className="mt-8 flex flex-col md:flex-row items-center gap-6">
              <Link
                to="/flavia"
                className="text-primary font-semibold hover:text-accent transition-colors flex items-center gap-2"
              >
                Conocer más sobre mi trayectoria
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-4 h-4">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3" />
                </svg>
              </Link>
              
              {/* Firma decorativa (Simulada con fuente cursiva o imagen) */}
              <span className="font-serif italic text-2xl text-accent/80">Flavia Dainotto.</span>
            </div>
          </div>

        </div>
      </div>
    </section>
  );
}

========== FILE: ./components/home/Testimonials.tsx ==========
export default function Testimonials() {
  const testimonials = [
    {
      id: 1,
      name: 'María González',
      service: 'Limpieza Facial Profunda',
      rating: 5,
      comment: 'Mi piel nunca se sintió mejor. El tratamiento personalizado fue excepcional. Flavia explica cada paso y los productos son increíbles.',
    },
    {
      id: 2,
      name: 'Laura Fernández',
      service: 'Peeling Químico',
      rating: 5,
      comment: 'Estaba nerviosa por el peeling, pero la delicadeza y profesionalismo me dieron total confianza. Los resultados superaron mis expectativas.',
    },
    {
      id: 3,
      name: 'Ana Rodríguez',
      service: 'Rutina Skincare',
      rating: 5,
      comment: 'No solo es el tratamiento, es lo que aprendes. Flavia me ayudó a armar una rutina simple que realmente puedo mantener en casa.',
    },
  ];

  return (
    <section className="py-24 bg-white">
      <div className="container mx-auto px-4">
        
        <div className="text-center mb-16">
          <h2 className="font-serif text-4xl font-bold text-primary mb-4">
            Historias Reales
          </h2>
          <p className="text-gray-500">La experiencia de quienes confían en nosotros.</p>
        </div>

        <div className="grid md:grid-cols-3 gap-8">
          {testimonials.map((t) => (
            <div 
              key={t.id} 
              className="bg-background rounded-3xl p-8 relative hover:-translate-y-1 transition-transform duration-300"
            >
              {/* Icono Comillas Decorativo */}
              <div className="absolute top-6 right-8 text-accent/20 text-6xl font-serif leading-none">
                "
              </div>

              {/* Estrellas */}
              <div className="flex gap-1 mb-6">
                {[...Array(5)].map((_, i) => (
                  <svg key={i} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className={`w-5 h-5 ${i < t.rating ? 'text-accent' : 'text-gray-300'}`}>
                    <path fillRule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clipRule="evenodd" />
                  </svg>
                ))}
              </div>

              <p className="text-gray-600 mb-6 font-sans italic relative z-10">
                "{t.comment}"
              </p>

              <div className="border-t border-gray-200 pt-4">
                <p className="font-bold text-primary font-serif">{t.name}</p>
                <p className="text-xs text-gray-400 uppercase tracking-wider mt-1">{t.service}</p>
              </div>
            </div>
          ))}
        </div>
        
      </div>
    </section>
  );
}

========== FILE: ./context/AuthContext.tsx ==========
import { createContext, useContext, useState, useEffect } from 'react';
import type { ReactNode } from 'react';
import { authApi } from '../api/auth';
import type { LoginRequest } from '../types/domain';

/**
 * Authentication context
 * Manages JWT token and admin authentication state
 */

interface AuthContextValue {
  token: string | null;
  username: string | null;
  isAuthenticated: boolean;
  login: (request: LoginRequest) => Promise<void>;
  logout: () => void;
}

const AuthContext = createContext<AuthContextValue | undefined>(undefined);

const TOKEN_STORAGE_KEY = 'authToken';
const USERNAME_STORAGE_KEY = 'authUsername';

// Provider component
export function AuthProvider({ children }: { children: ReactNode }) {
  const [token, setToken] = useState<string | null>(null);
  const [username, setUsername] = useState<string | null>(null);

  // Load token and username from localStorage on mount
  useEffect(() => {
    const savedToken = localStorage.getItem(TOKEN_STORAGE_KEY);
    const savedUsername = localStorage.getItem(USERNAME_STORAGE_KEY);

    if (savedToken) {
      setToken(savedToken);
    }
    if (savedUsername) {
      setUsername(savedUsername);
    }
  }, []);

  // Login function
  const login = async (request: LoginRequest) => {
    try {
      const response = await authApi.login(request);

      // Save token and username
      localStorage.setItem(TOKEN_STORAGE_KEY, response.token);
      localStorage.setItem(USERNAME_STORAGE_KEY, response.username);

      setToken(response.token);
      setUsername(response.username);
    } catch (error) {
      // Clear any existing auth data on login failure
      localStorage.removeItem(TOKEN_STORAGE_KEY);
      localStorage.removeItem(USERNAME_STORAGE_KEY);
      setToken(null);
      setUsername(null);

      throw error; // Re-throw to allow caller to handle
    }
  };

  // Logout function
  const logout = () => {
    localStorage.removeItem(TOKEN_STORAGE_KEY);
    localStorage.removeItem(USERNAME_STORAGE_KEY);
    setToken(null);
    setUsername(null);
  };

  const value: AuthContextValue = {
    token,
    username,
    isAuthenticated: token !== null,
    login,
    logout,
  };

  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;
}

// Custom hook to use auth context
export function useAuth(): AuthContextValue {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
}


========== FILE: ./context/CartContext.tsx ==========
import { createContext, useContext, useReducer, useEffect } from 'react';
import type { ReactNode } from 'react';
import type { CartItem, Product } from '../types/domain';

/**
 * Shopping cart context with reducer pattern
 * Persists to localStorage
 */

interface CartState {
  items: CartItem[];
}

type CartAction =
  | { type: 'ADD_ITEM'; payload: { product: Product; quantity: number } }
  | { type: 'REMOVE_ITEM'; payload: { productId: number } }
  | { type: 'UPDATE_QUANTITY'; payload: { productId: number; quantity: number } }
  | { type: 'CLEAR_CART' }
  | { type: 'LOAD_CART'; payload: CartItem[] };

interface CartContextValue {
  items: CartItem[];
  itemCount: number;
  subtotal: number;
  addItem: (product: Product, quantity: number) => void;
  removeItem: (productId: number) => void;
  updateQuantity: (productId: number, quantity: number) => void;
  clearCart: () => void;
}

const CartContext = createContext<CartContextValue | undefined>(undefined);

const CART_STORAGE_KEY = 'flavia_cart';

// Cart reducer
function cartReducer(state: CartState, action: CartAction): CartState {
  switch (action.type) {
    case 'ADD_ITEM': {
      const existingItemIndex = state.items.findIndex(
        (item) => item.product.id === action.payload.product.id
      );

      if (existingItemIndex >= 0) {
        // Update quantity of existing item
        const newItems = [...state.items];
        newItems[existingItemIndex] = {
          ...newItems[existingItemIndex],
          quantity: newItems[existingItemIndex].quantity + action.payload.quantity,
        };
        return { items: newItems };
      } else {
        // Add new item
        return {
          items: [
            ...state.items,
            {
              product: action.payload.product,
              quantity: action.payload.quantity,
            },
          ],
        };
      }
    }

    case 'REMOVE_ITEM': {
      return {
        items: state.items.filter((item) => item.product.id !== action.payload.productId),
      };
    }

    case 'UPDATE_QUANTITY': {
      if (action.payload.quantity <= 0) {
        // Remove item if quantity is 0 or negative
        return {
          items: state.items.filter((item) => item.product.id !== action.payload.productId),
        };
      }

      const newItems = state.items.map((item) =>
        item.product.id === action.payload.productId
          ? { ...item, quantity: action.payload.quantity }
          : item
      );
      return { items: newItems };
    }

    case 'CLEAR_CART': {
      return { items: [] };
    }

    case 'LOAD_CART': {
      return { items: action.payload };
    }

    default:
      return state;
  }
}

// Provider component
export function CartProvider({ children }: { children: ReactNode }) {
  const [state, dispatch] = useReducer(cartReducer, { items: [] });

  // Load cart from localStorage on mount
  useEffect(() => {
    const savedCart = localStorage.getItem(CART_STORAGE_KEY);
    if (savedCart) {
      try {
        const items = JSON.parse(savedCart) as CartItem[];
        dispatch({ type: 'LOAD_CART', payload: items });
      } catch (error) {
        console.error('Error loading cart from localStorage:', error);
      }
    }
  }, []);

  // Save cart to localStorage whenever it changes
  useEffect(() => {
    localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(state.items));
  }, [state.items]);

  // Computed values
  const itemCount = state.items.reduce((total, item) => total + item.quantity, 0);

  const subtotal = state.items.reduce(
    (total, item) => total + item.product.price * item.quantity,
    0
  );

  // Actions
  const addItem = (product: Product, quantity: number) => {
    if (quantity <= 0) {
      console.warn('Quantity must be positive');
      return;
    }
    if (quantity > product.stock) {
      console.warn('Quantity exceeds available stock');
      return;
    }
    dispatch({ type: 'ADD_ITEM', payload: { product, quantity } });
  };

  const removeItem = (productId: number) => {
    dispatch({ type: 'REMOVE_ITEM', payload: { productId } });
  };

  const updateQuantity = (productId: number, quantity: number) => {
    dispatch({ type: 'UPDATE_QUANTITY', payload: { productId, quantity } });
  };

  const clearCart = () => {
    dispatch({ type: 'CLEAR_CART' });
  };

  const value: CartContextValue = {
    items: state.items,
    itemCount,
    subtotal,
    addItem,
    removeItem,
    updateQuantity,
    clearCart,
  };

  return <CartContext.Provider value={value}>{children}</CartContext.Provider>;
}

// Custom hook to use cart context
export function useCart(): CartContextValue {
  const context = useContext(CartContext);
  if (context === undefined) {
    throw new Error('useCart must be used within a CartProvider');
  }
  return context;
}


========== FILE: ./layout/AdminLayout.tsx ==========
import { useState } from 'react';
import { Outlet, Navigate, Link, useLocation } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import { Toaster } from 'sonner';
import { 
  LayoutDashboard, 
  CalendarDays, 
  ShoppingBag, 
  Sparkles, 
  Package, 
  Settings, 
  Menu, 
  X, 
  LogOut,
  User
} from 'lucide-react';

// Tipado para los items del menú
interface LinkItemProps {
  to: string;
  icon: React.ElementType; 
  label: string;
  onClick?: () => void;
}

const LinkItem = ({ to, icon: Icon, label, onClick }: LinkItemProps) => {
  const location = useLocation();
  const isActive = location.pathname === to || (to !== '/admin' && location.pathname.startsWith(to));

  return (
    <Link
      to={to}
      onClick={onClick}
      className={`group flex items-center gap-3 px-4 py-2.5 rounded-lg transition-all duration-200 text-sm font-medium ${
        isActive
          ? 'bg-primary text-white shadow-md shadow-primary/20'
          : 'text-gray-500 hover:bg-gray-50 hover:text-gray-900'
      }`}
    >
      <Icon 
        size={18} 
        className={`transition-colors ${isActive ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'}`} 
        strokeWidth={2}
      />
      <span>{label}</span>
    </Link>
  );
};

// 1. COMPONENTE EXTRAÍDO (SOLUCIÓN AL ERROR ESLINT)
const SidebarContent = ({ onItemClick }: { onItemClick?: () => void }) => {
  // Movemos el hook aquí dentro para que tenga acceso al contexto
  const { logout, username } = useAuth(); 

  return (
    <div className="flex flex-col h-full bg-white">
      {/* Header Logo */}
      <div className="p-6 border-b border-gray-100 flex items-center gap-3">
        <div className="w-8 h-8 bg-primary text-white flex items-center justify-center rounded-lg font-serif font-bold italic">
          F
        </div>
        <div>
          <h2 className="font-serif text-lg font-bold text-primary leading-none">
            Flavia<span className="text-accent">.</span>
          </h2>
          <p className="text-[10px] text-gray-400 font-bold uppercase tracking-wider mt-1">Admin Panel</p>
        </div>
      </div>

      {/* Navegación */}
      <nav className="flex-1 px-3 py-6 space-y-1 overflow-y-auto">
        <LinkItem to="/admin" icon={LayoutDashboard} label="Resumen" onClick={onItemClick} />
        <LinkItem to="/admin/turnos" icon={CalendarDays} label="Agenda" onClick={onItemClick} />
        <LinkItem to="/admin/pedidos" icon={ShoppingBag} label="Pedidos" onClick={onItemClick} />
        
        <div className="pt-6 pb-2 px-4">
          <p className="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Catálogo</p>
        </div>
        <LinkItem to="/admin/servicios" icon={Sparkles} label="Servicios" onClick={onItemClick} />
        <LinkItem to="/admin/productos" icon={Package} label="Productos" onClick={onItemClick} />
        
        <div className="pt-6 pb-2 px-4">
          <p className="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Sistema</p>
        </div>
        <LinkItem to="/admin/config" icon={Settings} label="Configuración" onClick={onItemClick} />
      </nav>

      {/* Footer Usuario */}
      <div className="p-4 border-t border-gray-100 bg-gray-50/50">
        <div className="flex items-center gap-3 p-2 rounded-xl hover:bg-white transition-colors border border-transparent hover:border-gray-100">
          <div className="w-9 h-9 rounded-full bg-white border border-gray-200 flex items-center justify-center text-gray-400 shadow-sm">
            <User size={16} />
          </div>
          <div className="overflow-hidden flex-1">
            <p className="font-semibold text-xs text-gray-700 truncate">{username || 'Administrador'}</p>
            <p className="text-[10px] text-gray-400">Sesión activa</p>
          </div>
          <button 
            onClick={logout}
            className="p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all"
            title="Cerrar Sesión"
          >
            <LogOut size={16} />
          </button>
        </div>
      </div>
    </div>
  );
};

// 2. COMPONENTE PRINCIPAL LIMPIO
export default function AdminLayout() {
  const { isAuthenticated } = useAuth();
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

  if (!isAuthenticated) return <Navigate to="/admin/login" replace />;

  return (
    <div className="min-h-screen bg-gray-50/50 flex font-sans">
      {/* Sidebar Desktop */}
      <aside className="hidden md:flex flex-col w-64 bg-white border-r border-gray-200 fixed h-full z-20 shadow-[4px_0_24px_rgba(0,0,0,0.02)]">
        <SidebarContent />
      </aside>

      {/* Sidebar Mobile Overlay */}
      {isMobileMenuOpen && (
        <div className="fixed inset-0 z-50 md:hidden">
          <div className="fixed inset-0 bg-primary/20 backdrop-blur-sm transition-opacity" onClick={() => setIsMobileMenuOpen(false)} />
          <div className="fixed inset-y-0 left-0 w-72 bg-white shadow-2xl flex flex-col transform transition-transform duration-300">
            <button 
              onClick={() => setIsMobileMenuOpen(false)}
              className="absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 bg-gray-100 rounded-full"
            >
              <X size={20} />
            </button>
            <SidebarContent onItemClick={() => setIsMobileMenuOpen(false)} />
          </div>
        </div>
      )}

      {/* Contenido Principal */}
      <main className="flex-1 md:ml-64 min-h-screen flex flex-col">
        {/* Mobile Header */}
        <header className="md:hidden bg-white border-b border-gray-100 p-4 flex items-center justify-between sticky top-0 z-10 shadow-sm">
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-primary text-white flex items-center justify-center rounded-lg font-serif font-bold italic text-sm">F</div>
            <span className="font-serif font-bold text-primary">Flavia.</span>
          </div>
          <button 
            onClick={() => setIsMobileMenuOpen(true)}
            className="p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors"
          >
            <Menu size={24} />
          </button>
        </header>

        {/* Area de Contenido Scrollable */}
        <div className="flex-1 p-6 md:p-10 overflow-y-auto">
           <Outlet />
        </div>
      </main>
      
      <Toaster position="top-right" richColors closeButton theme="light" />
    </div>
  );
}

========== FILE: ./layout/MainLayout.tsx ==========
import { Outlet } from 'react-router-dom';
import Navbar from '../components/common/Navbar';

// Footer Component (Definido aquí mismo para simplificar, luego puedes moverlo)
const Footer = () => (
  <footer className="bg-white border-t border-gray-100 py-12 mt-auto">
    <div className="container mx-auto px-4">
      <div className="flex flex-col md:flex-row justify-between items-center gap-6">
        <div className="text-center md:text-left">
          <h3 className="font-serif text-xl font-bold text-accent mb-2">Flavia Dermobeauty</h3>
          <p className="text-gray-500 text-sm">Realzando tu belleza natural con ciencia y dedicación.</p>
        </div>
        <div className="flex gap-6 text-sm text-primary-light">
          <a href="#" className="hover:text-accent transition">Instagram</a>
          <a href="#" className="hover:text-accent transition">WhatsApp</a>
          <a href="#" className="hover:text-accent transition">Ubicación</a>
        </div>
      </div>
      <div className="border-t border-gray-100 mt-8 pt-8 text-center text-xs text-gray-400">
        &copy; {new Date().getFullYear()} Flavia Dermobeauty. Todos los derechos reservados.
      </div>
    </div>
  </footer>
);

export default function MainLayout() {
  return (
    <div className="min-h-screen flex flex-col bg-background font-sans text-primary">
      {/* Navbar fija */}
      <Navbar />
      
      {/* Contenido Dinámico */}
      <main className="flex-grow w-full">
        <Outlet />
      </main>
      
      {/* Footer Unificado */}
      <Footer />
    </div>
  );
}

========== FILE: ./main.tsx ==========
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './styles/index.css'
import App from './App.tsx'

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>,
)


========== FILE: ./pages/admin/AdminConfigPage.tsx ==========
import { useEffect, useState } from 'react';
import { adminApi } from '../../api/admin';
import ScheduleEditor from '../../components/admin/ScheduleEditor';
import { toast } from 'sonner';
import { 
  Store, 
  CalendarClock, 
  Truck, 
  LayoutTemplate, 
  Save, 
  Loader2,
  Globe,
  Instagram,
  MapPin,
  MessageCircle,
  Mail,
  AlertCircle
} from 'lucide-react';

// Definimos las secciones de configuración
// Eliminamos 'contact' porque la unificamos con 'general'
type SettingsTab = 'general' | 'agenda' | 'store' | 'content';

// Sub-componente de Botón de Menú Lateral (Corregido y Accesible)
const TabButton = ({ 
  id, 
  label, 
  icon: Icon, 
  description, 
  isActive, 
  onClick 
}: { 
  id: SettingsTab, 
  label: string, 
  icon: React.ElementType,
  description: string,
  isActive: boolean,
  onClick: () => void
}) => (
  <button
    type="button"
    id={`tab-${id}`} // ✅ CORRECCIÓN: Usamos la variable 'id'
    aria-selected={isActive}
    aria-controls={`panel-${id}`}
    role="tab"
    onClick={onClick}
    className={`w-full text-left p-4 rounded-xl transition-all duration-200 flex items-start gap-4 group ${
      isActive 
        ? 'bg-white shadow-md border border-gray-100 ring-1 ring-black/5' 
        : 'hover:bg-white/50 hover:shadow-sm'
    }`}
  >
    <div className={`p-2 rounded-lg transition-colors ${isActive ? 'bg-primary text-white' : 'bg-gray-100 text-gray-500 group-hover:text-primary'}`}>
      <Icon size={20} strokeWidth={2} />
    </div>
    <div>
      <span className={`block font-bold text-sm ${isActive ? 'text-gray-900' : 'text-gray-600'}`}>
        {label}
      </span>
      <span className="text-xs text-gray-400 font-medium leading-tight">
        {description}
      </span>
    </div>
  </button>
);

export default function AdminConfigPage() {
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [activeTab, setActiveTab] = useState<SettingsTab>('general');
  
  // Estado unificado para todos los valores (Key-Value map)
  const [values, setValues] = useState<Record<string, string>>({});

  useEffect(() => {
    loadConfig();
  }, []);

  const loadConfig = async () => {
    try {
      const data = await adminApi.config.getAll();
      const configMap: Record<string, string> = {};
      data.forEach(item => {
        configMap[item.key] = item.value;
      });
      setValues(configMap);
    } catch (error) {
      console.error(error);
      toast.error('Error al cargar configuración');
    } finally {
      setLoading(false);
    }
  };

  const handleChange = (key: string, value: string) => {
    setValues(prev => ({ ...prev, [key]: value }));
  };

  const handleSave = async () => {
    setSaving(true);
    try {
      const updates = Object.entries(values).map(([key, value]) => 
        adminApi.config.update(key, value)
      );

      await Promise.all(updates);
      toast.success('Configuración guardada correctamente', {
        description: 'Los cambios se verán reflejados en la web pública.'
      });
    } catch (error) {
      console.error(error);
      toast.error('Error al guardar los cambios');
    } finally {
      setSaving(false);
    }
  };

  if (loading) return (
    <div className="h-96 flex items-center justify-center text-gray-400">
      <Loader2 className="animate-spin mr-2" /> Cargando sistema...
    </div>
  );

  return (
    <div className="max-w-6xl mx-auto animate-fade-in pb-20">
      <div className="mb-8">
        <h1 className="text-3xl font-serif font-bold text-gray-900">Configuración del Sistema</h1>
        <p className="text-gray-500 mt-2">Controla la información pública, horarios y reglas de negocio.</p>
      </div>

      <div className="grid lg:grid-cols-12 gap-8">
        
        {/* SIDEBAR DE NAVEGACIÓN */}
        <div className="lg:col-span-4 space-y-2">
          <TabButton 
            id="general" label="Identidad & Contacto" icon={Store} description="Nombre, redes sociales y ubicación." 
            isActive={activeTab === 'general'} onClick={() => setActiveTab('general')}
          />
          <TabButton 
            id="agenda" label="Agenda & Turnos" icon={CalendarClock} description="Horarios de atención y políticas." 
            isActive={activeTab === 'agenda'} onClick={() => setActiveTab('agenda')}
          />
          <TabButton 
            id="store" label="Tienda & Envíos" icon={Truck} description="Costos de envío y reglas de venta." 
            isActive={activeTab === 'store'} onClick={() => setActiveTab('store')}
          />
          <TabButton 
            id="content" label="Contenido & Portada" icon={LayoutTemplate} description="Textos del Hero y banners." 
            isActive={activeTab === 'content'} onClick={() => setActiveTab('content')}
          />
        </div>

        {/* ÁREA DE CONTENIDO */}
        <div className="lg:col-span-8">
          <div className="bg-white rounded-2xl shadow-sm border border-gray-100 min-h-[500px] flex flex-col">
            
            {/* Header del Tab */}
            <div className="p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/30 rounded-t-2xl">
              <h2 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                {activeTab === 'general' && 'Información Pública'}
                {activeTab === 'agenda' && 'Reglas de Agenda'}
                {activeTab === 'store' && 'Configuración E-commerce'}
                {activeTab === 'content' && 'Gestión de Contenidos'}
              </h2>
              <button 
                onClick={handleSave}
                disabled={saving}
                className="flex items-center gap-2 bg-gray-900 text-white px-5 py-2 rounded-lg text-sm font-bold hover:bg-black transition-all shadow-lg shadow-gray-200 active:scale-95 disabled:opacity-50"
              >
                {saving ? <Loader2 size={16} className="animate-spin" /> : <Save size={16} />}
                Guardar
              </button>
            </div>

            {/* Body del Tab (Scrollable) */}
            <div className="p-8 space-y-8 flex-1">
              
              {/* --- TAB: IDENTIDAD & CONTACTO --- */}
              {activeTab === 'general' && (
                <div className="space-y-6 animate-fade-in">
                  <div className="grid grid-cols-1 gap-6">
                    <InputGroup label="Nombre del Sitio" description="Aparece en la pestaña del navegador y emails.">
                      <input 
                        type="text" 
                        value={values['site.name'] || ''}
                        onChange={e => handleChange('site.name', e.target.value)}
                        className="form-input" 
                      />
                    </InputGroup>
                    
                    <InputGroup label="Descripción Corta (SEO)" description="Resumen para Google (Meta Description).">
                      <textarea 
                        value={values['site.description'] || ''}
                        onChange={e => handleChange('site.description', e.target.value)}
                        className="form-textarea" 
                        rows={2}
                      />
                    </InputGroup>

                    <div className="border-t border-gray-100 pt-6">
                      <h3 className="font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <Globe size={18}/> Redes & Contacto
                      </h3>
                      <p className="text-sm text-gray-500 mb-4">Esta información se sincroniza automáticamente con el pie de página y la sección de contacto.</p>
                      
                      <div className="grid md:grid-cols-2 gap-6">
                        {/* WhatsApp */}
                        <div className="relative">
                          <label className="block text-sm font-bold text-gray-700 mb-1">WhatsApp</label>
                          <div className="relative">
                            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-green-600">
                              <MessageCircle size={18} />
                            </div>
                            <input 
                              type="text" 
                              placeholder="+54 9 11..."
                              value={values['contact.whatsapp'] || ''}
                              onChange={e => handleChange('contact.whatsapp', e.target.value)}
                              className="form-input pl-10" 
                            />
                          </div>
                        </div>

                        {/* Instagram */}
                        <div className="relative">
                          <label className="block text-sm font-bold text-gray-700 mb-1">Instagram</label>
                          <div className="relative">
                            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-pink-600">
                              <Instagram size={18} />
                            </div>
                            <input 
                              type="text" 
                              placeholder="URL Instagram"
                              value={values['social.instagram'] || ''}
                              onChange={e => handleChange('social.instagram', e.target.value)}
                              className="form-input pl-10" 
                            />
                          </div>
                        </div>

                        {/* Dirección */}
                        <div className="relative md:col-span-2">
                          <label className="block text-sm font-bold text-gray-700 mb-1">Dirección del Consultorio</label>
                          <div className="relative">
                            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400">
                              <MapPin size={18} />
                            </div>
                            <input 
                              type="text" 
                              placeholder="Av. Santa Fe 1234, CABA"
                              value={values['contact.address'] || ''}
                              onChange={e => handleChange('contact.address', e.target.value)}
                              className="form-input pl-10" 
                            />
                          </div>
                        </div>

                        {/* Email */}
                        <div className="relative md:col-span-2">
                          <label className="block text-sm font-bold text-gray-700 mb-1">Email de Contacto</label>
                          <div className="relative">
                            <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400">
                              <Mail size={18} />
                            </div>
                            <input 
                              type="email" 
                              placeholder="contacto@flavia.com"
                              value={values['contact.email'] || ''}
                              onChange={e => handleChange('contact.email', e.target.value)}
                              className="form-input pl-10" 
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* --- TAB: AGENDA --- */}
              {activeTab === 'agenda' && (
                <div className="space-y-8 animate-fade-in">
                  <div className="bg-blue-50 border border-blue-100 rounded-xl p-4 flex gap-3 text-blue-800 text-sm">
                    <AlertCircle size={20} className="flex-shrink-0" />
                    <p>Los cambios en los horarios base afectarán a la disponibilidad de turnos futuros.</p>
                  </div>

                  <div>
                    <h3 className="font-bold text-gray-900 mb-4">Horarios Semanales</h3>
                    <ScheduleEditor 
                      initialSchedule={values['schedule.weekly'] || '{}'} 
                      onSave={(json) => handleChange('schedule.weekly', json)} 
                    />
                  </div>

                  <InputGroup label="Política de Cancelación" description="Texto visible para el cliente al reservar.">
                    <textarea 
                      value={values['policy.cancellation'] || ''}
                      onChange={e => handleChange('policy.cancellation', e.target.value)}
                      className="form-textarea"
                      rows={3}
                    />
                  </InputGroup>
                </div>
              )}

              {/* --- TAB: STORE --- */}
              {activeTab === 'store' && (
                <div className="space-y-6 animate-fade-in">
                  <div className="grid md:grid-cols-2 gap-6">
                    <InputGroup label="Costo de Envío Fijo ($)" description="Valor único para envíos a domicilio.">
                      <div className="relative">
                        <span className="absolute left-3 top-2.5 text-gray-500">$</span>
                        <input 
                          type="number" 
                          value={values['delivery.fixed_cost'] || ''}
                          onChange={e => handleChange('delivery.fixed_cost', e.target.value)}
                          className="form-input pl-8" 
                        />
                      </div>
                    </InputGroup>

                    <InputGroup label="Envío GRATIS a partir de ($)" description="Deja en 0 para desactivar.">
                      <div className="relative">
                        <span className="absolute left-3 top-2.5 text-gray-500">$</span>
                        <input 
                          type="number" 
                          value={values['delivery.free_threshold'] || '0'}
                          onChange={e => handleChange('delivery.free_threshold', e.target.value)}
                          className="form-input pl-8" 
                        />
                      </div>
                    </InputGroup>
                  </div>

                  <div className="border-t border-gray-100 pt-6">
                    <InputGroup label="Política de Devolución" description="Texto legal sobre cambios y devoluciones.">
                      <textarea 
                        value={values['policy.returns'] || ''}
                        onChange={e => handleChange('policy.returns', e.target.value)}
                        className="form-textarea"
                        rows={4}
                      />
                    </InputGroup>
                  </div>
                </div>
              )}

              {/* --- TAB: CONTENT --- */}
              {activeTab === 'content' && (
                <div className="space-y-6 animate-fade-in">
                  <div className="bg-gray-50 p-4 rounded-xl border border-gray-200">
                    <h4 className="font-bold text-gray-900 mb-4">Sección Principal (Hero Home)</h4>
                    
                    <div className="space-y-4">
                      <InputGroup label="Título Principal">
                        <input 
                          type="text" 
                          value={values['hero.title'] || ''}
                          onChange={e => handleChange('hero.title', e.target.value)}
                          className="form-input font-serif text-lg" 
                        />
                      </InputGroup>
                      
                      <InputGroup label="Subtítulo">
                        <textarea 
                          value={values['hero.subtitle'] || ''}
                          onChange={e => handleChange('hero.subtitle', e.target.value)}
                          className="form-textarea"
                          rows={2}
                        />
                      </InputGroup>

                      <InputGroup label="Texto Botón CTA">
                        <input 
                          type="text" 
                          value={values['hero.cta_text'] || 'Reservar Turno'}
                          onChange={e => handleChange('hero.cta_text', e.target.value)}
                          className="form-input w-1/2" 
                        />
                      </InputGroup>
                    </div>
                  </div>
                </div>
              )}

            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

// Sub-componente simple para layout de inputs
const InputGroup = ({ label, description, children }: { label: string, description?: string, children: React.ReactNode }) => (
  <div className="space-y-1.5">
    <label className="block text-sm font-bold text-gray-900">{label}</label>
    {children}
    {description && <p className="text-xs text-gray-500">{description}</p>}
  </div>
);

========== FILE: ./pages/admin/AdminDashboardPage.tsx ==========
import { useEffect, useState } from 'react';
import { Link } from 'react-router-dom';
import { adminApi } from '../../api/admin';

// 1. Definimos la interfaz para las props del componente interno
interface StatCardProps {
  title: string;
  value: number | string; // Puede ser número o '-' cuando carga
  icon: React.ReactNode;
  link: string;
  colorClass: string;
}

export default function AdminDashboardPage() {
  const [stats, setStats] = useState({
    bookingsToday: 0,
    pendingOrders: 0,
    activeProducts: 0,
    totalServices: 0,
  });
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadStats();
  }, []);

  const loadStats = async () => {
    try {
      const [services, products, bookings, orders] = await Promise.all([
        adminApi.services.getAll(),
        adminApi.products.getAll(),
        adminApi.bookings.getAll(),
        adminApi.orders.getAll(),
      ]);

      // Calculamos turnos de HOY (en local time para simplificar visualización)
      const todayStr = new Date().toISOString().split('T')[0];
      const todayBookings = bookings.filter(
        (b) => b.bookingDate === todayStr && b.status !== 'CANCELLED'
      );

      setStats({
        totalServices: services.filter((s) => s.isActive).length,
        activeProducts: products.filter((p) => p.isActive).length,
        bookingsToday: todayBookings.length,
        pendingOrders: orders.filter((o) => o.status === 'PENDING').length,
      });
    } catch (err) {
      console.error('Error loading stats:', err);
    } finally {
      setLoading(false);
    }
  };

  // 2. Usamos la interfaz aquí en lugar de 'any'
  const StatCard = ({ title, value, icon, link, colorClass }: StatCardProps) => (
    <Link 
      to={link}
      className="bg-white p-6 rounded-3xl shadow-sm hover:shadow-soft transition-all duration-300 group border border-gray-50 flex items-center justify-between"
    >
      <div>
        <p className="text-gray-400 text-xs font-bold uppercase tracking-wider mb-1">{title}</p>
        <h3 className="text-4xl font-serif font-bold text-primary group-hover:text-accent transition-colors">
          {loading ? '-' : value}
        </h3>
      </div>
      <div className={`w-12 h-12 rounded-full flex items-center justify-center text-xl ${colorClass}`}>
        {icon}
      </div>
    </Link>
  );

  return (
    <div>
      {/* Header */}
      <div className="mb-10 flex flex-col md:flex-row md:items-end justify-between gap-4">
        <div>
          <h1 className="font-serif text-3xl font-bold text-primary">
            Hola, <span className="text-accent">{'mamá'}</span>
          </h1>
          <p className="text-gray-500 mt-1">
            Aquí tienes el resumen de tu negocio hoy.
          </p>
        </div>
        <div className="text-sm font-medium text-gray-400 bg-white px-4 py-2 rounded-full shadow-sm border border-gray-100">
          {new Date().toLocaleDateString('es-AR', { weekday: 'long', day: 'numeric', month: 'long' })}
        </div>
      </div>

      {/* KPI Grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
        <StatCard 
          title="Turnos Hoy" 
          value={stats.bookingsToday} 
          icon="📅" 
          link="/admin/turnos"
          colorClass="bg-blue-50 text-blue-500"
        />
        <StatCard 
          title="Pedidos Pendientes" 
          value={stats.pendingOrders} 
          icon="📦" 
          link="/admin/pedidos"
          colorClass="bg-orange-50 text-orange-500"
        />
        <StatCard 
          title="Productos Activos" 
          value={stats.activeProducts} 
          icon="🧴" 
          link="/admin/productos"
          colorClass="bg-pink-50 text-pink-500"
        />
        <StatCard 
          title="Servicios" 
          value={stats.totalServices} 
          icon="💆‍♀️" 
          link="/admin/servicios"
          colorClass="bg-purple-50 text-purple-500"
        />
      </div>

      {/* Acciones Rápidas */}
      <div className="grid lg:grid-cols-2 gap-8">
        
        {/* Panel Izquierdo */}
        <div className="bg-white p-8 rounded-3xl shadow-soft border border-gray-50">
          <h3 className="font-serif text-xl font-bold text-primary mb-6">Acciones Rápidas</h3>
          <div className="grid grid-cols-2 gap-4">
            <Link to="/admin/servicios" className="p-4 rounded-2xl bg-gray-50 hover:bg-accent/10 hover:text-accent transition text-center group">
              <span className="text-2xl block mb-2 group-hover:scale-110 transition-transform">✨</span>
              <span className="font-medium text-sm">Nuevo Servicio</span>
            </Link>
            <Link to="/admin/productos" className="p-4 rounded-2xl bg-gray-50 hover:bg-accent/10 hover:text-accent transition text-center group">
              <span className="text-2xl block mb-2 group-hover:scale-110 transition-transform">📦</span>
              <span className="font-medium text-sm">Cargar Stock</span>
            </Link>
            <Link to="/admin/config" className="p-4 rounded-2xl bg-gray-50 hover:bg-accent/10 hover:text-accent transition text-center group">
              <span className="text-2xl block mb-2 group-hover:scale-110 transition-transform">⏰</span>
              <span className="font-medium text-sm">Editar Horarios</span>
            </Link>
            <div className="p-4 rounded-2xl bg-gray-50 text-gray-300 text-center cursor-not-allowed">
              <span className="text-2xl block mb-2">📊</span>
              <span className="font-medium text-sm">Reportes (Pronto)</span>
            </div>
          </div>
        </div>

        {/* Panel Derecho */}
        <div className="bg-primary p-8 rounded-3xl shadow-soft text-white relative overflow-hidden flex flex-col justify-between">
           <div className="relative z-10">
             <h3 className="font-serif text-2xl font-bold mb-2">Estado del Sistema</h3>
             <p className="text-white/70 text-sm mb-6">Tu plataforma está funcionando correctamente.</p>
             
             <div className="space-y-3">
               <div className="flex items-center gap-3 text-sm">
                 <div className="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                 <span>Base de datos conectada</span>
               </div>
               <div className="flex items-center gap-3 text-sm">
                 <div className="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                 <span>Pagos habilitados (Mercado Pago)</span>
               </div>
             </div>
           </div>

           {/* Decoración */}
           <div className="absolute -bottom-10 -right-10 w-48 h-48 bg-white/10 rounded-full blur-2xl"></div>
           <div className="absolute top-10 right-10 w-20 h-20 bg-accent/20 rounded-full blur-xl"></div>
        </div>

      </div>
    </div>
  );
}

========== FILE: ./pages/admin/AdminLoginPage.tsx ==========
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';
import { User, Lock, ArrowRight, Loader2, AlertCircle } from 'lucide-react';

export default function AdminLoginPage() {
  const navigate = useNavigate();
  const { login } = useAuth();
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError(null);
    setLoading(true);

    try {
      await login({ username, password });
      navigate('/admin');
    } catch (err) {
      console.error('Login error:', err);
      setError('Credenciales inválidas. Por favor verifica tus datos.');
      setLoading(false);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50/50 relative overflow-hidden">
      
      {/* Decoración de Fondo (Sutil) */}
      <div className="absolute top-0 left-0 w-full h-full overflow-hidden z-0 pointer-events-none">
        <div className="absolute -top-[10%] -left-[10%] w-[40%] h-[40%] rounded-full bg-accent/5 blur-3xl"></div>
        <div className="absolute top-[20%] right-[10%] w-[20%] h-[20%] rounded-full bg-primary/5 blur-3xl"></div>
      </div>

      <div className="w-full max-w-md p-4 relative z-10 animate-fade-in-up">
        
        {/* Tarjeta de Login */}
        <div className="bg-white rounded-3xl shadow-xl shadow-gray-200/50 border border-white p-8 md:p-10">
          
          {/* Header */}
          <div className="text-center mb-10">
            <div className="w-16 h-16 bg-primary text-white text-2xl font-serif font-bold italic flex items-center justify-center rounded-2xl mx-auto mb-6 shadow-lg shadow-primary/20">
              F
            </div>
            <h1 className="font-serif text-3xl font-bold text-gray-900 mb-2">
              Bienvenida
            </h1>
            <p className="text-gray-500 text-sm">
              Ingresa al panel de administración de <br/>
              <span className="font-medium text-gray-700">Flavia Dermobeauty</span>
            </p>
          </div>

          {/* Formulario */}
          <form onSubmit={handleSubmit} className="space-y-5">
            
            {/* Input Usuario */}
            <div className="space-y-1.5">
              <label className="text-xs font-bold text-gray-600 uppercase tracking-wider ml-1">Usuario</label>
              <div className="relative group">
                <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400 group-focus-within:text-primary transition-colors">
                  <User size={20} />
                </div>
                <input
                  type="text"
                  value={username}
                  onChange={(e) => setUsername(e.target.value)}
                  className="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all placeholder:text-gray-400 text-gray-900"
                  placeholder="admin"
                  required
                  autoFocus
                />
              </div>
            </div>

            {/* Input Contraseña */}
            <div className="space-y-1.5">
              <label className="text-xs font-bold text-gray-600 uppercase tracking-wider ml-1">Contraseña</label>
              <div className="relative group">
                <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400 group-focus-within:text-primary transition-colors">
                  <Lock size={20} />
                </div>
                <input
                  type="password"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all placeholder:text-gray-400 text-gray-900"
                  placeholder="••••••••"
                  required
                />
              </div>
            </div>

            {/* Mensaje de Error */}
            {error && (
              <div className="flex items-center gap-2 p-3 rounded-lg bg-red-50 text-red-600 text-sm border border-red-100 animate-shake">
                <AlertCircle size={16} className="flex-shrink-0" />
                <p>{error}</p>
              </div>
            )}

            {/* Botón de Acción */}
            <button
              type="submit"
              disabled={loading}
              className="w-full bg-primary text-white py-3.5 rounded-xl font-bold hover:bg-gray-900 transition-all shadow-lg shadow-primary/20 active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-4"
            >
              {loading ? (
                <>
                  <Loader2 size={20} className="animate-spin" />
                  Ingresando...
                </>
              ) : (
                <>
                  Iniciar Sesión
                  <ArrowRight size={20} />
                </>
              )}
            </button>
          </form>

          {/* Footer Card */}
          <div className="mt-8 text-center pt-6 border-t border-dashed border-gray-100">
            <a 
              href="/" 
              className="text-xs font-medium text-gray-400 hover:text-primary transition-colors inline-flex items-center gap-1 group"
            >
              <span className="group-hover:-translate-x-1 transition-transform">←</span> Volver al sitio público
            </a>
          </div>

        </div>
        
        {/* Copyright Footer */}
        <p className="text-center text-xs text-gray-400 mt-8">
          &copy; {new Date().getFullYear()} Flavia Dermobeauty System.
        </p>
      </div>
    </div>
  );
}

========== FILE: ./pages/admin/AdminPedidosPage.tsx ==========
import { useEffect, useState } from 'react';
import { adminApi } from '../../api/admin';
import { OrderStatus } from '../../types/domain';
import type { Order } from '../../types/domain';
import { toast } from 'sonner';
import { 
  ChevronDown, 
  ChevronUp, 
  Package, 
  Truck, 
  User, 
  Search,
} from 'lucide-react';

export default function AdminPedidosPage() {
  const [orders, setOrders] = useState<Order[]>([]);
  const [loading, setLoading] = useState(true);
  const [filterStatus, setFilterStatus] = useState<string>('ALL');
  const [expandedOrderId, setExpandedOrderId] = useState<number | null>(null);

  useEffect(() => {
    loadOrders();
  }, []);

  const loadOrders = async () => {
    try {
      setLoading(true);
      const data = await adminApi.orders.getAll();
      const sorted = data.sort((a, b) => {
        const dateA = new Date(a.createdAt || 0);
        const dateB = new Date(b.createdAt || 0);
        return dateB.getTime() - dateA.getTime();
      });
      setOrders(sorted);
    } catch (err) {
      console.error(err);
      toast.error('Error al cargar pedidos');
    } finally {
      setLoading(false);
    }
  };

  const handleStatusChange = async (id: number, newStatus: OrderStatus) => {
    const promise = adminApi.orders.updateStatus(id, newStatus)
      .then(() => loadOrders());

    toast.promise(promise, {
      loading: 'Actualizando estado...',
      success: 'Estado actualizado correctamente',
      error: 'Error al actualizar estado'
    });
  };

  const filteredOrders = filterStatus === 'ALL'
    ? orders
    : orders.filter((o) => o.status === filterStatus);

  // Helper de estilos
  const getStatusStyle = (status: string) => {
    switch (status) {
      case 'PAID': return 'bg-emerald-100 text-emerald-700 border-emerald-200';
      case 'DELIVERED': return 'bg-gray-100 text-gray-700 border-gray-200';
      case 'CANCELLED': return 'bg-red-50 text-red-600 border-red-100';
      case 'PENDING': return 'bg-amber-50 text-amber-600 border-amber-100';
      default: return 'bg-blue-50 text-blue-600 border-blue-100';
    }
  };

  if (loading) return <div className="p-10 text-center text-gray-400">Cargando pedidos...</div>;

  return (
    <div className="max-w-7xl mx-auto animate-fade-in pb-20">
      {/* Header */}
      <div className="flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900 tracking-tight">Gestión de Pedidos</h1>
          <p className="text-gray-500 text-sm mt-1">Supervisa compras y envíos en tiempo real.</p>
        </div>
      </div>

      {/* Filtros */}
      <div className="flex overflow-x-auto gap-2 mb-6 pb-2 no-scrollbar">
        {['ALL', 'PENDING', 'PAID', 'PREPARING', 'READY', 'DELIVERED', 'CANCELLED'].map((status) => (
          <button
            key={status}
            onClick={() => setFilterStatus(status)}
            className={`px-4 py-2 rounded-full text-xs font-bold transition-all border whitespace-nowrap ${
              filterStatus === status
                ? 'bg-gray-900 text-white border-gray-900 shadow-md'
                : 'bg-white text-gray-500 border-gray-200 hover:border-gray-300 hover:bg-gray-50'
            }`}
          >
            {status === 'ALL' ? 'Todos' : status}
          </button>
        ))}
      </div>

      {/* Tabla */}
      <div className="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead className="bg-gray-50/50 border-b border-gray-200">
              <tr>
                <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">ID</th>
                <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Cliente</th>
                <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Entrega</th>
                <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Total</th>
                <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Estado</th>
                <th className="px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider">Acción</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-100">
              {filteredOrders.map((order) => (
                <>
                  <tr 
                    key={order.id} 
                    className={`group transition-colors ${expandedOrderId === order.id ? 'bg-gray-50' : 'hover:bg-gray-50/50'}`}
                  >
                    <td className="px-6 py-4 text-sm font-mono text-gray-500">#{order.orderNumber.split('-')[1]}</td>
                    <td className="px-6 py-4">
                      <div className="flex items-center gap-3">
                        <div className="p-2 bg-gray-100 rounded-full text-gray-400 group-hover:bg-white group-hover:text-primary transition-colors">
                          <User size={16} />
                        </div>
                        <div>
                          <p className="font-semibold text-gray-900 text-sm">{order.customerInfo.name}</p>
                          <p className="text-xs text-gray-500">{order.customerInfo.email}</p>
                        </div>
                      </div>
                    </td>
                    <td className="px-6 py-4">
                      <div className="flex items-center gap-2">
                        {order.deliveryInfo.deliveryType === 'HOME_DELIVERY' 
                          ? <Truck size={14} className="text-blue-500" />
                          : <Package size={14} className="text-orange-500" />
                        }
                        <span className="text-sm text-gray-700 font-medium">
                          {order.deliveryInfo.deliveryType === 'HOME_DELIVERY' ? 'Envío' : 'Retiro'}
                        </span>
                      </div>
                    </td>
                    <td className="px-6 py-4">
                      <span className="font-bold text-gray-900">${order.total}</span>
                    </td>
                    <td className="px-6 py-4">
                      <select
                        value={order.status}
                        onChange={(e) => handleStatusChange(order.id, e.target.value as OrderStatus)}
                        className={`text-xs font-bold px-3 py-1.5 rounded-full border appearance-none cursor-pointer outline-none transition-all ${getStatusStyle(order.status)}`}
                        disabled={order.status === 'CANCELLED' || order.status === 'DELIVERED'}
                      >
                        <option value="PENDING">PENDIENTE</option>
                        <option value="PAID">PAGADO</option>
                        <option value="PREPARING">PREPARANDO</option>
                        <option value="READY">LISTO</option>
                        <option value="DELIVERED">ENTREGADO</option>
                        <option value="CANCELLED">CANCELADO</option>
                      </select>
                    </td>
                    <td className="px-6 py-4 text-right">
                      <button
                        onClick={() => setExpandedOrderId(expandedOrderId === order.id ? null : order.id)}
                        className="text-gray-400 hover:text-primary transition-colors"
                      >
                        {expandedOrderId === order.id ? <ChevronUp size={20} /> : <ChevronDown size={20} />}
                      </button>
                    </td>
                  </tr>
                  
                  {/* Detalle Expandible */}
                  {expandedOrderId === order.id && (
                    <tr className="bg-gray-50">
                      <td colSpan={6} className="px-6 py-6">
                        <div className="bg-white rounded-xl border border-gray-200 p-6 shadow-sm">
                          <h4 className="font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <Package size={18} /> Detalle del Pedido
                          </h4>
                          
                          <div className="grid md:grid-cols-2 gap-8">
                            <ul className="space-y-3">
                              {order.items.map((item, idx) => (
                                <li key={idx} className="flex justify-between items-center text-sm border-b border-gray-100 pb-2 last:border-0">
                                  <div className="flex gap-3">
                                    <span className="font-bold text-gray-900">{item.quantity}x</span>
                                    <span className="text-gray-600">{item.productName}</span>
                                  </div>
                                  <span className="font-medium text-gray-900">${item.subtotal}</span>
                                </li>
                              ))}
                            </ul>
                            
                            <div className="bg-gray-50 p-4 rounded-lg space-y-3 text-sm">
                              <div className="flex justify-between text-gray-500">
                                <span>Subtotal</span>
                                <span>${order.subtotal}</span>
                              </div>
                              <div className="flex justify-between text-gray-500">
                                <span>Envío</span>
                                <span>${order.deliveryCost}</span>
                              </div>
                              <div className="flex justify-between font-bold text-lg text-primary pt-2 border-t border-gray-200">
                                <span>Total</span>
                                <span>${order.total}</span>
                              </div>
                              
                              {order.deliveryInfo.deliveryType === 'HOME_DELIVERY' && (
                                <div className="mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500">
                                  <p className="font-bold uppercase mb-1">Dirección de Entrega:</p>
                                  <p>{order.deliveryInfo.deliveryAddress}</p>
                                  <p>{order.deliveryInfo.deliveryCity}, {order.deliveryInfo.deliveryProvince}</p>
                                  <p>CP: {order.deliveryInfo.deliveryPostalCode}</p>
                                </div>
                              )}
                            </div>
                          </div>
                        </div>
                      </td>
                    </tr>
                  )}
                </>
              ))}
            </tbody>
          </table>
        </div>
        
        {filteredOrders.length === 0 && (
          <div className="py-12 text-center">
            <div className="w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300">
              <Search size={24} />
            </div>
            <p className="text-gray-500 font-medium">No hay pedidos en esta categoría</p>
          </div>
        )}
      </div>
    </div>
  );
}

========== FILE: ./pages/admin/AdminProductosPage.tsx ==========
import { useEffect, useState } from 'react';
import { adminApi } from '../../api/admin';
import Modal from '../../components/admin/Modal';
import ProductForm from '../../components/admin/ProductForm';
import type { Product } from '../../types/domain';
import { toast } from 'sonner';
import { 
  Plus, 
  Edit2, 
  Trash2, 
  Star, 
  AlertCircle 
} from 'lucide-react';

export default function AdminProductosPage() {
  const [products, setProducts] = useState<Product[]>([]);
  const [loading, setLoading] = useState(true);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [editingProduct, setEditingProduct] = useState<Product | null>(null);

  useEffect(() => {
    loadProducts();
  }, []);

  const loadProducts = async () => {
    try {
      setLoading(true);
      const data = await adminApi.products.getAll();
      setProducts(data);
    } catch (err) {
      console.error(err);
      toast.error('No se pudieron cargar los productos');
    } finally {
      setLoading(false);
    }
  };

  const handleToggleFeatured = async (id: number) => {
    try {
      await adminApi.products.toggleFeatured(id);
      loadProducts();
      toast.success('Estado destacado actualizado');
    } catch {
      toast.error('Error al actualizar');
    }
  };

  const handleDelete = async (id: number, name: string) => {
    if (!confirm(`¿Eliminar "${name}" permanentemente?`)) return; // TODO: Custom Confirm Dialog

    try {
      await adminApi.products.delete(id);
      setProducts(prev => prev.filter(p => p.id !== id));
      toast.success('Producto eliminado');
    } catch {
      toast.error('Error al eliminar producto');
    }
  };

  const handleSubmit = async (data: Partial<Product>) => {
    try {
      if (editingProduct) {
        await adminApi.products.update(editingProduct.id, data);
        toast.success('Producto actualizado');
      } else {
        await adminApi.products.create(data);
        toast.success('Producto creado exitosamente');
      }
      setIsModalOpen(false);
      loadProducts();
    } catch (err) {
      console.error(err);
      toast.error('Error al guardar');
      throw err;
    }
  };

  const openCreate = () => { setEditingProduct(null); setIsModalOpen(true); };
  const openEdit = (p: Product) => { setEditingProduct(p); setIsModalOpen(true); };

  if (loading) return <div className="p-10 text-center text-gray-400">Cargando catálogo...</div>;

  return (
    <div className="max-w-7xl mx-auto animate-fade-in pb-20">
      
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-2xl font-bold text-gray-900 tracking-tight">Productos</h1>
          <p className="text-gray-500 text-sm mt-1">Gestiona el inventario de tu tienda.</p>
        </div>
        <button
          onClick={openCreate}
          className="flex items-center gap-2 bg-primary text-white px-5 py-2.5 rounded-xl font-bold text-sm hover:bg-primary-dark transition-all shadow-lg shadow-primary/20 active:scale-95"
        >
          <Plus size={18} /> Nuevo Producto
        </button>
      </div>

      <div className="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
        <table className="w-full">
          <thead className="bg-gray-50/50 border-b border-gray-200">
            <tr>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Producto</th>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Categoría</th>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Precio</th>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Stock</th>
              <th className="px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider">Acciones</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-100">
            {products.map((product) => (
              <tr key={product.id} className="group hover:bg-gray-50/50 transition-colors">
                <td className="px-6 py-4">
                  <div className="flex items-center gap-4">
                    <div className="w-12 h-12 rounded-lg bg-gray-100 border border-gray-200 overflow-hidden flex-shrink-0">
                      <img 
                        src={product.imageUrl || '/placeholder.jpg'} 
                        alt="" 
                        className="w-full h-full object-cover"
                        onError={(e) => (e.currentTarget.src = 'https://placehold.co/100x100?text=IMG')}
                      />
                    </div>
                    <div>
                      <p className="font-bold text-gray-900 text-sm">{product.name}</p>
                      <div className="flex gap-2 mt-1">
                        {product.isOffer && <span className="text-[10px] bg-red-100 text-red-600 px-2 py-0.5 rounded-full font-bold">OFERTA</span>}
                        {product.isTrending && <span className="text-[10px] bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full font-bold">TREND</span>}
                      </div>
                    </div>
                  </div>
                </td>
                <td className="px-6 py-4 text-sm text-gray-500 font-medium">
                  {product.categoryName}
                </td>
                <td className="px-6 py-4">
                  <span className="font-mono font-bold text-gray-900">${product.price}</span>
                </td>
                <td className="px-6 py-4">
                  {product.stock <= 5 ? (
                    <div className="flex items-center gap-1 text-red-500 font-bold text-sm">
                      <AlertCircle size={14} />
                      <span>{product.stock} (Bajo)</span>
                    </div>
                  ) : (
                    <span className="text-gray-600 font-medium text-sm">{product.stock} unid.</span>
                  )}
                </td>
                <td className="px-6 py-4">
                  <div className="flex items-center justify-end gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                    <button 
                      onClick={() => handleToggleFeatured(product.id)}
                      className={`p-2 rounded-lg transition-colors ${product.isFeatured ? 'text-yellow-500 bg-yellow-50' : 'text-gray-400 hover:bg-gray-100'}`}
                      title="Destacar"
                    >
                      <Star size={18} fill={product.isFeatured ? "currentColor" : "none"} />
                    </button>
                    <button 
                      onClick={() => openEdit(product)}
                      className="p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors"
                      title="Editar"
                    >
                      <Edit2 size={18} />
                    </button>
                    <button 
                      onClick={() => handleDelete(product.id, product.name)}
                      className="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors"
                      title="Eliminar"
                    >
                      <Trash2 size={18} />
                    </button>
                  </div>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
        
        {products.length === 0 && (
          <div className="py-12 text-center text-gray-400 text-sm">No hay productos registrados.</div>
        )}
      </div>

      <Modal
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
        title={editingProduct ? 'Editar Producto' : 'Nuevo Producto'}
      >
        <ProductForm
          product={editingProduct}
          onSubmit={handleSubmit}
          onCancel={() => setIsModalOpen(false)}
        />
      </Modal>
    </div>
  );
}

========== FILE: ./pages/admin/AdminServiciosPage.tsx ==========
import { useEffect, useState } from 'react';
import { adminApi } from '../../api/admin';
import Modal from '../../components/admin/Modal';
import ServiceForm from '../../components/admin/ServiceForm';
import type { Service } from '../../types/domain';
import { toast } from 'sonner';
import { 
  Plus, 
  Edit2, 
  Trash2, 
  Star, 
  Clock,
  Sparkles
} from 'lucide-react';

export default function AdminServiciosPage() {
  const [services, setServices] = useState<Service[]>([]);
  const [loading, setLoading] = useState(true);
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [editingService, setEditingService] = useState<Service | null>(null);

  useEffect(() => {
    loadServices();
  }, []);

  const loadServices = async () => {
    try {
      setLoading(true);
      const data = await adminApi.services.getAll();
      setServices(data);
    } catch (err) {
      console.error(err);
      toast.error('Error al cargar servicios');
    } finally {
      setLoading(false);
    }
  };

  const handleToggleFeatured = async (id: number) => {
    try {
      await adminApi.services.toggleFeatured(id);
      loadServices();
      toast.success('Visibilidad actualizada');
    } catch {
      toast.error('Error al actualizar');
    }
  };

  const handleDelete = async (id: number, name: string) => {
    if (!confirm(`¿Eliminar el servicio "${name}"?`)) return;

    try {
      await adminApi.services.delete(id);
      setServices(prev => prev.filter(s => s.id !== id));
      toast.success('Servicio eliminado');
    } catch {
      toast.error('Error al eliminar servicio');
    }
  };

  const handleSubmit = async (data: Partial<Service>) => {
    try {
      if (editingService) {
        await adminApi.services.update(editingService.id, data);
        toast.success('Servicio actualizado');
      } else {
        await adminApi.services.create(data);
        toast.success('Servicio creado');
      }
      setIsModalOpen(false);
      loadServices();
    } catch (err) {
      console.error(err);
      toast.error('Error al guardar');
      throw err;
    }
  };

  const openCreate = () => { setEditingService(null); setIsModalOpen(true); };
  const openEdit = (s: Service) => { setEditingService(s); setIsModalOpen(true); };

  if (loading) return <div className="p-10 text-center text-gray-400">Cargando servicios...</div>;

  return (
    <div className="max-w-7xl mx-auto animate-fade-in pb-20">
      
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-2xl font-bold text-gray-900 tracking-tight">Servicios</h1>
          <p className="text-gray-500 text-sm mt-1">Configura los tratamientos disponibles para reserva.</p>
        </div>
        <button
          onClick={openCreate}
          className="flex items-center gap-2 bg-primary text-white px-5 py-2.5 rounded-xl font-bold text-sm hover:bg-primary-dark transition-all shadow-lg shadow-primary/20 active:scale-95"
        >
          <Plus size={18} /> Nuevo Servicio
        </button>
      </div>

      <div className="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
        <table className="w-full">
          <thead className="bg-gray-50/50 border-b border-gray-200">
            <tr>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Servicio</th>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Categoría</th>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Precio</th>
              <th className="px-6 py-4 text-left text-xs font-bold text-gray-400 uppercase tracking-wider">Duración</th>
              <th className="px-6 py-4 text-right text-xs font-bold text-gray-400 uppercase tracking-wider">Acciones</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-100">
            {services.map((service) => (
              <tr key={service.id} className="group hover:bg-gray-50/50 transition-colors">
                <td className="px-6 py-4">
                  <div className="flex items-center gap-4">
                    <div className="w-12 h-12 rounded-lg bg-accent/10 border border-accent/20 flex items-center justify-center flex-shrink-0 text-accent">
                      {service.imageUrl ? (
                         <img src={service.imageUrl} className="w-full h-full object-cover rounded-lg" alt="" />
                      ) : (
                         <Sparkles size={20} />
                      )}
                    </div>
                    <div>
                      <p className="font-bold text-gray-900 text-sm">{service.name}</p>
                      {service.isActive ? (
                        <span className="text-[10px] text-green-600 font-bold">● Activo</span>
                      ) : (
                        <span className="text-[10px] text-gray-400 font-bold">● Pausado</span>
                      )}
                    </div>
                  </div>
                </td>
                <td className="px-6 py-4 text-sm text-gray-500 font-medium">
                  {service.categoryName || '-'}
                </td>
                <td className="px-6 py-4">
                  <span className="font-mono font-bold text-gray-900">${service.price}</span>
                </td>
                <td className="px-6 py-4">
                  <div className="flex items-center gap-2 text-sm text-gray-600 bg-gray-50 w-max px-3 py-1 rounded-full border border-gray-100">
                    <Clock size={14} className="text-gray-400" />
                    <span>{service.durationMinutes} min</span>
                  </div>
                </td>
                <td className="px-6 py-4">
                  <div className="flex items-center justify-end gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                    <button 
                      onClick={() => handleToggleFeatured(service.id)}
                      className={`p-2 rounded-lg transition-colors ${service.isFeatured ? 'text-yellow-500 bg-yellow-50' : 'text-gray-400 hover:bg-gray-100'}`}
                      title="Destacar en Home"
                    >
                      <Star size={18} fill={service.isFeatured ? "currentColor" : "none"} />
                    </button>
                    <button 
                      onClick={() => openEdit(service)}
                      className="p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors"
                      title="Editar"
                    >
                      <Edit2 size={18} />
                    </button>
                    <button 
                      onClick={() => handleDelete(service.id, service.name)}
                      className="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors"
                      title="Eliminar"
                    >
                      <Trash2 size={18} />
                    </button>
                  </div>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      <Modal
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
        title={editingService ? 'Editar Servicio' : 'Nuevo Servicio'}
      >
        <ServiceForm
          service={editingService}
          onSubmit={handleSubmit}
          onCancel={() => setIsModalOpen(false)}
        />
      </Modal>
    </div>
  );
}

========== FILE: ./pages/admin/AdminTurnosPage.tsx ==========
import { useEffect, useState } from 'react';
import { adminApi } from '../../api/admin';
import { turnosApi } from '../../api/turnos'; // Para crear el turno
import { serviciosApi } from '../../api/servicios'; // Para listar servicios
import { addMonths, subMonths, format } from 'date-fns';
import { es } from 'date-fns/locale';
import YearView from '../../components/admin/calendar/YearView';
import MonthView from '../../components/admin/calendar/MonthView';
import DayView from '../../components/admin/calendar/DayView';
import Modal from '../../components/admin/Modal';
import DateTimePicker from '../../components/booking/DateTimePicker';
import type { Booking, Service, CreateBookingRequest } from '../../types/domain';

type CalendarView = 'year' | 'month' | 'day';

export default function AdminTurnosPage() {
  const [view, setView] = useState<CalendarView>('month');
  const [currentDate, setCurrentDate] = useState(new Date());
  const [bookings, setBookings] = useState<Booking[]>([]);
  const [loading, setLoading] = useState(true);

  // ESTADOS PARA MODAL DE NUEVO TURNO
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [services, setServices] = useState<Service[]>([]);
  const [selectedServiceId, setSelectedServiceId] = useState<number | null>(null);
  const [bookingDate, setBookingDate] = useState('');
  const [bookingTime, setBookingTime] = useState('');
  
  // Datos Cliente Manual
  const [manualName, setManualName] = useState('');
  const [manualPhone, setManualPhone] = useState('');
  const [isBlock, setIsBlock] = useState(false); // Checkbox para "Bloquear Horario"

  useEffect(() => {
    loadBookings();
    loadServices();
  }, []);

  const loadBookings = async () => {
    try {
      const data = await adminApi.bookings.getAll();
      setBookings(data.filter(b => b.status !== 'CANCELLED'));
    } catch (err) { console.error(err); } finally { setLoading(false); }
  };

  const loadServices = async () => {
    try {
      const data = await serviciosApi.getAll();
      setServices(data.filter(s => s.isActive));
    } catch (err) { console.error(err); }
  };

  const handlePrev = () => {
    if (view === 'year') setCurrentDate(d => subMonths(d, 12));
    if (view === 'month') setCurrentDate(d => subMonths(d, 1));
    if (view === 'day') setCurrentDate(d => subMonths(d, 1)); // Fix: Day prev
  };

  const handleNext = () => {
    if (view === 'year') setCurrentDate(d => addMonths(d, 12));
    if (view === 'month') setCurrentDate(d => addMonths(d, 1));
    if (view === 'day') setCurrentDate(d => addMonths(d, 1)); // Fix: Day next
  };

  const handleCreateTurno = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!selectedServiceId || !bookingDate || !bookingTime) return;

    const service = services.find(s => s.id === selectedServiceId);
    if (!service) return;

    try {
      const request: CreateBookingRequest = {
        serviceId: service.id,
        customerName: isBlock ? "BLOQUEO AGENDA" : manualName,
        customerEmail: isBlock ? "admin@interno.com" : "cliente@manual.com", // Dummy email
        customerWhatsapp: isBlock ? "00000000" : manualPhone,
        customerComments: isBlock ? "Horario bloqueado por admin" : "Reserva manual (Teléfono/Presencial)",
        bookingDate,
        bookingTime,
        durationMinutes: service.durationMinutes,
        amount: service.price
      };

      // Usamos la API pública para crear (reutilización de lógica)
      await turnosApi.create(request);
      
      // Nota: No redirigimos a MercadoPago. Asumimos que es pago en efectivo o bloqueo.
      // El backend lo deja en PENDING. Podríamos agregar un endpoint para pasarlo a CONFIRMED directo,
      // pero para MVP basta con crearlo.

      alert(isBlock ? 'Horario bloqueado con éxito' : 'Turno agendado con éxito');
      setIsModalOpen(false);
      
      // Reset form
      setManualName('');
      setManualPhone('');
      setIsBlock(false);
      setBookingDate('');
      setBookingTime('');
      
      loadBookings(); // Recargar calendario
    } catch (error) {
      console.error(error);
      alert('Error al crear el turno. Verificá que el horario esté disponible.');
    }
  };

  return (
    <div className="space-y-6">
      {/* HEADER DE CONTROLES (Igual que antes pero con onClick real) */}
      <div className="flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-4 rounded-3xl shadow-sm border border-gray-50">
        <div className="flex bg-gray-100 p-1 rounded-2xl">
          {(['year', 'month', 'day'] as CalendarView[]).map((v) => (
            <button
              key={v}
              onClick={() => setView(v)}
              className={`px-4 py-2 rounded-xl text-sm font-medium transition-all ${
                view === v ? 'bg-white text-accent shadow-sm' : 'text-gray-500 hover:text-gray-700'
              }`}
            >
              {v === 'year' ? 'Año' : v === 'month' ? 'Mes' : 'Día'}
            </button>
          ))}
        </div>

        <div className="flex items-center gap-4">
          <button onClick={handlePrev} className="p-2 hover:bg-gray-100 rounded-full text-gray-500">←</button>
          <h2 className="font-serif text-xl font-bold text-primary min-w-[200px] text-center capitalize">
            {view === 'year' ? format(currentDate, 'yyyy') : format(currentDate, 'MMMM yyyy', { locale: es })}
          </h2>
          <button onClick={handleNext} className="p-2 hover:bg-gray-100 rounded-full text-gray-500">→</button>
        </div>

        <button 
          onClick={() => setIsModalOpen(true)}
          className="bg-accent text-white px-6 py-2.5 rounded-full font-bold shadow-soft hover:shadow-lg transition-all text-sm"
        >
          + Nuevo Turno
        </button>
      </div>

      {/* VISTAS CALENDARIO */}
      <div className="min-h-[500px]">
        {loading ? (
          <div className="flex justify-center items-center h-64 text-gray-400">Cargando agenda...</div>
        ) : (
          <>
            {view === 'year' && <YearView currentDate={currentDate} onMonthSelect={(d) => { setCurrentDate(d); setView('month'); }} />}
            {view === 'month' && <MonthView currentDate={currentDate} bookings={bookings} onDaySelect={(d) => { setCurrentDate(d); setView('day'); }} />}
            {view === 'day' && <DayView currentDate={currentDate} bookings={bookings} />}
          </>
        )}
      </div>

      {/* MODAL NUEVO TURNO / BLOQUEO */}
      <Modal 
        isOpen={isModalOpen} 
        onClose={() => setIsModalOpen(false)} 
        title="Agendar Turno Manual"
      >
        <form onSubmit={handleCreateTurno} className="space-y-6">
          
          {/* Selector de Servicio */}
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">Servicio</label>
            <select 
              className="w-full border rounded-lg p-2"
              value={selectedServiceId || ''}
              onChange={(e) => setSelectedServiceId(Number(e.target.value))}
              required
            >
              <option value="">Seleccionar...</option>
              {services.map(s => (
                <option key={s.id} value={s.id}>{s.name} ({s.durationMinutes} min)</option>
              ))}
            </select>
            <p className="text-xs text-gray-500 mt-1">
              Para bloquear un horario, selecciona cualquier servicio o crea uno llamado "Bloqueo" de 30/60 min.
            </p>
          </div>

          {/* Selector Fecha/Hora (Reusando componente inteligente) */}
          {selectedServiceId && (
            <div className="bg-gray-50 p-4 rounded-xl">
              <DateTimePicker 
                serviceId={selectedServiceId}
                date={bookingDate}
                time={bookingTime}
                onDateChange={setBookingDate}
                onTimeChange={setBookingTime}
              />
            </div>
          )}

          {/* Checkbox Bloqueo */}
          <div className="flex items-center gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-100">
            <input 
              type="checkbox" 
              id="blockCheck"
              checked={isBlock}
              onChange={(e) => setIsBlock(e.target.checked)}
              className="w-4 h-4 text-accent rounded"
            />
            <label htmlFor="blockCheck" className="text-sm font-medium text-yellow-800 cursor-pointer select-none">
              Es un bloqueo de agenda (No es un cliente real)
            </label>
          </div>

          {/* Datos Cliente (Solo si no es bloqueo) */}
          {!isBlock && (
            <div className="grid grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Nombre Cliente</label>
                <input 
                  type="text" 
                  value={manualName}
                  onChange={(e) => setManualName(e.target.value)}
                  className="w-full border rounded-lg p-2"
                  required={!isBlock}
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Teléfono</label>
                <input 
                  type="text" 
                  value={manualPhone}
                  onChange={(e) => setManualPhone(e.target.value)}
                  className="w-full border rounded-lg p-2"
                  required={!isBlock}
                />
              </div>
            </div>
          )}

          <div className="flex justify-end pt-4">
            <button 
              type="submit" 
              disabled={!bookingDate || !bookingTime || !selectedServiceId}
              className="bg-primary text-white px-6 py-2 rounded-lg font-bold hover:bg-primary-dark disabled:opacity-50"
            >
              {isBlock ? 'Bloquear Horario' : 'Agendar Turno'}
            </button>
          </div>
        </form>
      </Modal>
    </div>
  );
}

========== FILE: ./pages/CarritoPage.tsx ==========
import { useState } from 'react';
import { Link } from 'react-router-dom';
import { useCart } from '../context/CartContext';
import { pedidosApi } from '../api/pedidos';
import { DeliveryType } from '../types/domain';
import type { CreateOrderRequest } from '../types/domain';

// Costo de envío fijo (Debería venir del backend, pero lo dejamos visual por ahora)
const DELIVERY_COST = 1500; 

export default function CarritoPage() {
  const { items, subtotal, updateQuantity, removeItem, clearCart } = useCart();
  const [loading, setLoading] = useState(false);
  
  // Estado del Formulario
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    whatsapp: '',
    address: '',
    city: '',
    province: '',
    postalCode: '',
    comments: ''
  });
  
  const [deliveryType, setDeliveryType] = useState<DeliveryType>('PICKUP');

  // Cálculos
  const shippingCost = deliveryType === 'HOME_DELIVERY' ? DELIVERY_COST : 0;
  const total = subtotal + shippingCost;

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (items.length === 0) return;

    // Validación básica manual
    if (deliveryType === 'HOME_DELIVERY' && (!formData.address || !formData.city)) {
      alert("Por favor completa la dirección de envío");
      return;
    }

    setLoading(true);

    try {
      // 1. Preparar Payload
      const orderRequest: CreateOrderRequest = {
        customerName: formData.name,
        customerEmail: formData.email,
        customerWhatsapp: formData.whatsapp,
        customerComments: formData.comments || null,
        deliveryType: deliveryType,
        deliveryAddress: deliveryType === 'HOME_DELIVERY' ? formData.address : null,
        deliveryCity: deliveryType === 'HOME_DELIVERY' ? formData.city : null,
        deliveryProvince: deliveryType === 'HOME_DELIVERY' ? formData.province : null,
        deliveryPostalCode: deliveryType === 'HOME_DELIVERY' ? formData.postalCode : null,
        items: items.map(item => ({
          productId: item.product.id,
          quantity: item.quantity
        }))
      };

      // 2. Crear Orden en Backend
      const order = await pedidosApi.create(orderRequest);

      // 3. Crear Preferencia de Pago MP
      const preference = await pedidosApi.createPaymentPreference(order.id);

      // 4. Limpiar y Redirigir
      clearCart();
      window.location.href = preference.initPoint;

    } catch (err) {
      console.error(err);
      alert("Hubo un error al procesar tu pedido. Intenta nuevamente.");
      setLoading(false);
    }
  };

  if (items.length === 0) {
    return (
      <div className="min-h-screen bg-background flex flex-col items-center justify-center p-4">
        <div className="bg-white p-12 rounded-3xl text-center max-w-md shadow-soft">
          <div className="w-20 h-20 bg-accent/10 rounded-full flex items-center justify-center mx-auto mb-6 text-accent">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-10 h-10">
              <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 5c.07.286-.06.591-.292.684l-1.428.571M12 18.75a6 6 0 006-6M12 18.75a6 6 0 01-6-6m0 0V6m0 0A2.25 2.25 0 0113.5 2.25H15" />
            </svg>
          </div>
          <h2 className="font-serif text-2xl font-bold text-primary mb-2">Tu carrito está vacío</h2>
          <p className="text-gray-500 mb-8">Descubrí nuestros productos y empezá a cuidar tu piel hoy.</p>
          <Link to="/productos" className="bg-primary text-white px-8 py-3 rounded-full font-medium hover:bg-accent transition-colors">
            Ir a la Tienda
          </Link>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-background py-12">
      <div className="container mx-auto px-4 max-w-6xl">
        <h1 className="font-serif text-4xl font-bold text-primary mb-12 text-center">Finalizar Compra</h1>

        <div className="grid lg:grid-cols-2 gap-12 items-start">
          
          {/* COLUMNA IZQUIERDA: ITEMS */}
          <div className="space-y-6">
            <div className="bg-white p-6 rounded-3xl shadow-sm">
              <h3 className="font-serif text-xl font-bold mb-6">Tu Pedido</h3>
              <div className="space-y-6">
                {items.map((item) => (
                  <div key={item.product.id} className="flex gap-4 items-center">
                    <div className="w-20 h-20 bg-gray-50 rounded-xl overflow-hidden flex-shrink-0">
                      <img 
                        src={item.product.imageUrl || '/placeholder.jpg'} 
                        alt={item.product.name} 
                        className="w-full h-full object-cover"
                        onError={(e) => (e.currentTarget.src = 'https://placehold.co/100x100')}
                      />
                    </div>
                    <div className="flex-grow">
                      <h4 className="font-sans font-medium text-primary">{item.product.name}</h4>
                      <p className="text-sm text-gray-500">${item.product.price} x {item.quantity}</p>
                    </div>
                    <div className="flex items-center gap-3">
                      <div className="flex items-center bg-gray-50 rounded-lg">
                        <button 
                          onClick={() => updateQuantity(item.product.id, item.quantity - 1)}
                          className="px-3 py-1 text-gray-500 hover:text-primary"
                        >-</button>
                        <span className="text-sm font-medium">{item.quantity}</span>
                        <button 
                          onClick={() => updateQuantity(item.product.id, item.quantity + 1)}
                          disabled={item.quantity >= item.product.stock}
                          className="px-3 py-1 text-gray-500 hover:text-primary disabled:opacity-30"
                        >+</button>
                      </div>
                      <button 
                        onClick={() => removeItem(item.product.id)}
                        className="text-red-300 hover:text-red-500"
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" className="w-5 h-5">
                          <path fillRule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z" clipRule="evenodd" />
                        </svg>
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* COLUMNA DERECHA: DATOS + CHECKOUT */}
          <div className="space-y-6">
            <form onSubmit={handleSubmit} className="bg-white p-8 rounded-3xl shadow-soft space-y-6">
              <h3 className="font-serif text-xl font-bold mb-4">Datos de Contacto</h3>
              
              <div className="space-y-4">
                <input
                  type="text" name="name" placeholder="Nombre completo" required
                  value={formData.name} onChange={handleInputChange}
                  className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all"
                />
                <div className="grid grid-cols-2 gap-4">
                  <input
                    type="email" name="email" placeholder="Email" required
                    value={formData.email} onChange={handleInputChange}
                    className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all"
                  />
                  <input
                    type="tel" name="whatsapp" placeholder="WhatsApp (Ej: 1155556666)" required
                    value={formData.whatsapp} onChange={handleInputChange}
                    className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent/50 transition-all"
                  />
                </div>
              </div>

              {/* TIPO ENTREGA */}
              <div className="pt-4">
                <h4 className="font-medium text-primary mb-3">Método de Entrega</h4>
                <div className="grid grid-cols-2 gap-4">
                  <button
                    type="button"
                    onClick={() => setDeliveryType('PICKUP')}
                    className={`p-4 rounded-xl border-2 transition-all text-sm font-medium ${
                      deliveryType === 'PICKUP' ? 'border-accent bg-accent/5 text-accent' : 'border-gray-100 text-gray-500 hover:border-gray-200'
                    }`}
                  >
                    Retiro en Local
                    <span className="block text-xs font-normal mt-1">Gratis</span>
                  </button>
                  <button
                    type="button"
                    onClick={() => setDeliveryType('HOME_DELIVERY')}
                    className={`p-4 rounded-xl border-2 transition-all text-sm font-medium ${
                      deliveryType === 'HOME_DELIVERY' ? 'border-accent bg-accent/5 text-accent' : 'border-gray-100 text-gray-500 hover:border-gray-200'
                    }`}
                  >
                    Envío a Domicilio
                    <span className="block text-xs font-normal mt-1">+${DELIVERY_COST}</span>
                  </button>
                </div>
              </div>

              {/* DIRECCIÓN (Condicional) */}
              {deliveryType === 'HOME_DELIVERY' && (
                <div className="space-y-4 animate-fade-in">
                  <input
                    type="text" name="address" placeholder="Calle y altura"
                    value={formData.address} onChange={handleInputChange}
                    className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent/50"
                  />
                  <div className="grid grid-cols-2 gap-4">
                    <input
                      type="text" name="city" placeholder="Ciudad"
                      value={formData.city} onChange={handleInputChange}
                      className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent/50"
                    />
                    <input
                      type="text" name="postalCode" placeholder="CP"
                      value={formData.postalCode} onChange={handleInputChange}
                      className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-accent/50"
                    />
                  </div>
                </div>
              )}

              {/* RESUMEN FINAL */}
              <div className="border-t border-gray-100 pt-6 mt-6 space-y-2">
                <div className="flex justify-between text-gray-500">
                  <span>Subtotal</span>
                  <span>${subtotal}</span>
                </div>
                <div className="flex justify-between text-gray-500">
                  <span>Envío</span>
                  <span>{shippingCost === 0 ? 'Gratis' : `$${shippingCost}`}</span>
                </div>
                <div className="flex justify-between text-xl font-bold text-primary pt-2">
                  <span>Total</span>
                  <span>${total}</span>
                </div>
              </div>

              <button
                type="submit"
                disabled={loading}
                className="w-full bg-primary text-white py-4 rounded-xl font-bold text-lg hover:bg-accent transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
              >
                {loading ? 'Procesando...' : 'Pagar con Mercado Pago'}
              </button>
              
              <p className="text-center text-xs text-gray-400 mt-2">
                Serás redirigido a Mercado Pago para completar el pago de forma segura.
              </p>

            </form>
          </div>

        </div>
      </div>
    </div>
  );
}

========== FILE: ./pages/FlaviaPage.tsx ==========
import fotoFlavia from '../assets/flavia.jpg';

export default function FlaviaPage() {
  return (
    <div className="min-h-screen bg-background">
      
      {/* 1. HERO BIO: Introducción e Imagen */}
      <section className="pt-16 pb-20 lg:pt-24 lg:pb-32">
        <div className="container mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex flex-col lg:flex-row items-center gap-16">
            
            {/* Imagen con Marco Decorativo */}
            <div className="w-full lg:w-1/2 relative flex justify-center">
              <div className="relative w-80 h-96 lg:w-[450px] lg:h-[550px]">
                {/* Marco desplazado */}
                <div className="absolute inset-0 border-2 border-accent rounded-[3rem] transform translate-x-6 translate-y-6"></div>
                {/* Imagen */}
                <img 
                  src={fotoFlavia}
                  alt="Flavia Dermocosmiatra" 
                  className="absolute inset-0 w-full h-full object-cover rounded-[3rem] shadow-xl z-10"
                />
                {/* Badge Flotante */}
                <div className="absolute -bottom-6 -left-6 bg-white p-6 rounded-2xl shadow-soft z-20 max-w-[200px] hidden md:block">
                  <p className="font-serif text-4xl font-bold text-accent mb-1">+10</p>
                  <p className="text-xs text-gray-500 font-medium uppercase tracking-wide">Años de Trayectoria</p>
                </div>
              </div>
            </div>

            {/* Texto Bio */}
            <div className="w-full lg:w-1/2 text-center lg:text-left">
              <span className="text-accent font-bold tracking-widest text-xs uppercase mb-4 block">Sobre Mí</span>
              <h1 className="font-serif text-5xl lg:text-6xl font-bold text-primary mb-8 leading-tight">
                Pasión por la <br/>
                <span className="italic text-accent">Belleza Saludable</span>
              </h1>
              
              <div className="space-y-6 text-gray-600 text-lg leading-relaxed font-sans">
                <p>
                  Hola, soy Flavia. Mi viaje en la dermocosmiatría comenzó con una simple creencia: <strong className="text-primary font-medium">la piel es el reflejo de nuestra salud integral.</strong>
                </p>
                <p>
                  A lo largo de mi carrera, me he dedicado a perfeccionar técnicas que no solo tratan afecciones superficiales, sino que buscan restaurar el equilibrio natural de la piel. Me alejo de las "modas pasajeras" para enfocarme en la ciencia dermatológica aplicada con calidez humana.
                </p>
                <p>
                  Mi consultorio es un espacio seguro donde cada tratamiento se diseña a medida. No creo en soluciones únicas para todos, porque cada rostro cuenta una historia diferente.
                </p>
              </div>

              {/* Firma */}
              <div className="mt-10">
                <p className="font-serif text-2xl text-primary italic">Flavia Dainotto.</p>
                <p className="text-xs text-gray-400 mt-1 uppercase tracking-wider">Fundadora & Directora</p>
              </div>
            </div>

          </div>
        </div>
      </section>

      {/* 2. FILOSOFÍA & CREDENCIALES (Fondo Blanco) */}
      <section className="py-24 bg-white">
        <div className="container mx-auto px-4 sm:px-6 lg:px-8">
          
          <div className="text-center max-w-3xl mx-auto mb-16">
            <h2 className="font-serif text-3xl font-bold text-primary mb-4">Formación y Excelencia</h2>
            <p className="text-gray-500">Capacitación constante para brindarte lo mejor de la vanguardia estética.</p>
          </div>

          <div className="grid md:grid-cols-3 gap-8">
            {/* Card 1 */}
            <div className="bg-background rounded-3xl p-8 hover:-translate-y-2 transition-transform duration-300 border border-gray-100">
              <div className="w-12 h-12 bg-accent/10 rounded-full flex items-center justify-center text-accent mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.499 5.24 50.552 50.552 0 00-2.658.813m-15.482 0A50.553 50.553 0 0112 13.489a50.551 50.551 0 016.482-1.206M6.75 21.75h10.5c-2.75-4.25-5.25-4.25-5.25-4.25s-2.5 0-5.25 4.25z" />
                </svg>
              </div>
              <h3 className="font-serif font-bold text-xl text-primary mb-2">Dermocosmiatría</h3>
              <p className="text-gray-500 text-sm leading-relaxed">
                Títulación oficial técnica superior. Especialización en anatomía facial y patologías cutáneas.
              </p>
            </div>

            {/* Card 2 */}
            <div className="bg-background rounded-3xl p-8 hover:-translate-y-2 transition-transform duration-300 border border-gray-100">
              <div className="w-12 h-12 bg-accent/10 rounded-full flex items-center justify-center text-accent mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0112 15a9.065 9.065 0 00-6.23-.693L5 14.5m14.8.8l1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0112 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5" />
                </svg>
              </div>
              <h3 className="font-serif font-bold text-xl text-primary mb-2">Química Cosmética</h3>
              <p className="text-gray-500 text-sm leading-relaxed">
                Certificación en formulación y activos. Selección rigurosa de productos basada en evidencia científica.
              </p>
            </div>

            {/* Card 3 */}
            <div className="bg-background rounded-3xl p-8 hover:-translate-y-2 transition-transform duration-300 border border-gray-100">
              <div className="w-12 h-12 bg-accent/10 rounded-full flex items-center justify-center text-accent mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
                </svg>
              </div>
              <h3 className="font-serif font-bold text-xl text-primary mb-2">Enfoque Holístico</h3>
              <p className="text-gray-500 text-sm leading-relaxed">
                Especialización en masajes faciales y técnicas de relajación para complementar los tratamientos clínicos.
              </p>
            </div>
          </div>

        </div>
      </section>

      {/* 3. SOCIAL CONTACT */}
      <section className="py-20 container mx-auto px-4 text-center">
        <h2 className="font-serif text-3xl font-bold text-primary mb-8">Sigamos Conectados</h2>
        <div className="flex justify-center gap-6">
          <a
            href="https://instagram.com/flavia.dermobeauty"
            target="_blank"
            rel="noopener noreferrer"
            className="group flex items-center gap-3 bg-white px-6 py-3 rounded-full shadow-sm hover:shadow-md transition-all border border-gray-100"
          >
            <span className="text-pink-500 text-xl group-hover:scale-110 transition-transform">📸</span>
            <span className="font-medium text-gray-600 group-hover:text-primary">Instagram</span>
          </a>
          
          <a
            href="https://wa.me/5491112345678"
            target="_blank"
            rel="noopener noreferrer"
            className="group flex items-center gap-3 bg-white px-6 py-3 rounded-full shadow-sm hover:shadow-md transition-all border border-gray-100"
          >
            <span className="text-green-500 text-xl group-hover:scale-110 transition-transform">💬</span>
            <span className="font-medium text-gray-600 group-hover:text-primary">WhatsApp</span>
          </a>
        </div>
      </section>

    </div>
  );
}

========== FILE: ./pages/HomePage.tsx ==========
import HeroSection from '../components/home/HeroSection';
import FeaturedServices from '../components/home/FeaturedServices';
import FeaturedProducts from '../components/home/FeaturedProducts';
import Testimonials from '../components/home/Testimonials';
import MiniBio from '../components/home/MiniBio';

/**
 * Home page
 * Professional landing page with hero, services, products, testimonials, and bio
 */

export default function HomePage() {
  return (
    <div>
      <HeroSection />
      <FeaturedServices />
      <FeaturedProducts />
      <Testimonials />
      <MiniBio />
    </div>
  );
}


========== FILE: ./pages/PaymentFailurePage.tsx ==========
import { Link } from 'react-router-dom';

export default function PaymentFailurePage() {
  return (
    <div className="min-h-screen bg-background flex items-center justify-center p-4">
      <div className="bg-white p-12 rounded-[2rem] shadow-soft max-w-md w-full text-center">
        <div className="w-20 h-20 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6">
          <span className="text-4xl">😕</span>
        </div>
        <h1 className="font-serif text-2xl font-bold text-primary mb-2">Hubo un problema</h1>
        <p className="text-gray-500 mb-8">
          No pudimos procesar tu pago. Por favor intenta nuevamente o contáctanos.
        </p>
        <Link to="/reservar" className="block w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors">
          Intentar Nuevamente
        </Link>
      </div>
    </div>
  );
}

========== FILE: ./pages/PaymentSuccessPage.tsx ==========
import { Link, useSearchParams } from 'react-router-dom';

export default function PaymentSuccessPage() {
  const [searchParams] = useSearchParams();
  const paymentId = searchParams.get('payment_id');

  return (
    <div className="min-h-screen bg-background flex items-center justify-center p-4">
      <div className="bg-white p-8 md:p-12 rounded-[2rem] shadow-soft max-w-lg w-full text-center border border-gray-50">
        
        <div className="w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mx-auto mb-6">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-12 h-12 text-green-500">
            <path strokeLinecap="round" strokeLinejoin="round" d="M4.5 12.75l6 6 9-13.5" />
          </svg>
        </div>

        <h1 className="font-serif text-3xl font-bold text-primary mb-2">¡Reserva Confirmada!</h1>
        <p className="text-gray-500 mb-6">
          Tu pago se acreditó correctamente. Te enviamos los detalles a tu email.
        </p>

        {paymentId && (
          <div className="bg-gray-50 py-2 px-4 rounded-lg inline-block mb-8">
            <span className="text-xs text-gray-400 uppercase tracking-wider font-bold">ID de Pago:</span>
            <span className="ml-2 text-sm font-mono text-gray-600">#{paymentId}</span>
          </div>
        )}

        <div className="space-y-3">
          <Link 
            to="/"
            className="block w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-accent transition-colors shadow-lg"
          >
            Volver al Inicio
          </Link>
          <Link 
            to="/productos"
            className="block w-full bg-white text-primary border border-gray-200 py-3 rounded-xl font-medium hover:border-accent hover:text-accent transition-colors"
          >
            Ver Productos
          </Link>
        </div>

      </div>
    </div>
  );
}

========== FILE: ./pages/ProductDetailPage.tsx ==========
import { useEffect, useState } from 'react';
import { useParams, Link } from 'react-router-dom';
import { productosApi } from '../api/productos';
import { useCart } from '../context/CartContext';
import type { Product } from '../types/domain';

export default function ProductDetailPage() {
  const { slug } = useParams<{ slug: string }>();
  const [product, setProduct] = useState<Product | null>(null);
  const [loading, setLoading] = useState(true);
  const [quantity, setQuantity] = useState(1);
  const { addItem } = useCart();

  useEffect(() => {
    const loadProduct = async () => {
      if (!slug) return;
      try {
        setLoading(true);
        // Asumiendo que agregas getBySlug a tu API client
        // Si no tienes getBySlug, usa getAll y find (menos performante pero funciona para MVP)
        const allProducts = await productosApi.getAll(); 
        const found = allProducts.find(p => p.slug === slug);
        setProduct(found || null);
      } catch (err) {
        console.error(err);
      } finally {
        setLoading(false);
      }
    };
    loadProduct();
  }, [slug]);

  if (loading) return <div className="min-h-screen flex items-center justify-center text-accent">Cargando...</div>;
  if (!product) return <div className="min-h-screen flex items-center justify-center">Producto no encontrado</div>;

  const handleAddToCart = () => {
    addItem(product, quantity);
    // Feedback visual o toast aquí
  };

  return (
    <div className="min-h-screen bg-background py-12 animate-fade-in">
      <div className="container mx-auto px-4 max-w-6xl">
        <Link to="/productos" className="text-sm text-gray-500 hover:text-primary mb-8 inline-block">← Volver a la tienda</Link>
        
        <div className="grid md:grid-cols-2 gap-12 bg-white p-8 rounded-[3rem] shadow-soft">
          {/* Columna Imagen */}
          <div className="relative aspect-square rounded-3xl overflow-hidden bg-gray-50">
            <img 
              src={product.imageUrl || '/placeholder.jpg'} 
              alt={product.name}
              className="w-full h-full object-cover"
            />
            {product.isOffer && (
              <span className="absolute top-6 left-6 bg-accent text-white px-4 py-1 rounded-full text-sm font-bold tracking-wider">
                OFERTA
              </span>
            )}
          </div>

          {/* Columna Info */}
          <div className="flex flex-col justify-center">
            <span className="text-gray-400 text-sm font-bold uppercase tracking-wider mb-2">{product.categoryName}</span>
            <h1 className="font-serif text-4xl font-bold text-primary mb-4">{product.name}</h1>
            <div className="text-3xl font-light text-primary mb-6">${product.price}</div>
            
            <p className="text-gray-600 leading-relaxed mb-8 font-sans">
              {product.description}
            </p>

            {/* Controles de Stock y Add */}
            <div className="border-t border-gray-100 pt-8 mt-auto">
              {product.stock > 0 ? (
                <div className="flex flex-col sm:flex-row gap-4">
                  <div className="flex items-center border border-gray-200 rounded-full px-4 h-12 w-max">
                    <button 
                      onClick={() => setQuantity(Math.max(1, quantity - 1))}
                      className="text-gray-500 hover:text-primary text-xl px-2"
                    >-</button>
                    <span className="mx-4 font-medium w-4 text-center">{quantity}</span>
                    <button 
                      onClick={() => setQuantity(Math.min(product.stock, quantity + 1))}
                      className="text-gray-500 hover:text-primary text-xl px-2"
                    >+</button>
                  </div>
                  
                  <button 
                    onClick={handleAddToCart}
                    className="flex-1 bg-primary text-white h-12 rounded-full font-bold hover:bg-accent transition-all shadow-lg hover:shadow-xl hover:-translate-y-0.5"
                  >
                    Agregar al Carrito
                  </button>
                </div>
              ) : (
                <div className="bg-gray-100 text-gray-500 py-3 px-6 rounded-full text-center font-medium">
                  Sin Stock Momentáneamente
                </div>
              )}
              
              <div className="mt-6 flex gap-4 text-sm text-gray-400">
                <span className="flex items-center gap-2">
                  ✓ Envío a todo el país
                </span>
                <span className="flex items-center gap-2">
                  ✓ Compra protegida
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

========== FILE: ./pages/ProductosPage.tsx ==========
import { useEffect, useState } from 'react';
import { productosApi } from '../api/productos';
import { categoriasApi } from '../api/categorias';
import ProductoCard from '../components/catalog/ProductoCard'; 
import type { Product, Category } from '../types/domain';
import { CategoryType } from '../types/domain';

export default function ProductosPage() {
  const [products, setProducts] = useState<Product[]>([]);
  const [categories, setCategories] = useState<Category[]>([]);
  const [selectedFilter, setSelectedFilter] = useState<string>('All');
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const loadData = async () => {
      try {
        setLoading(true);
        const [productsData, categoriesData] = await Promise.all([
          productosApi.getAll(),
          categoriasApi.getByType(CategoryType.PRODUCT),
        ]);
        setProducts(productsData);
        setCategories(categoriesData);
      } catch (err) {
        console.error(err);
      } finally {
        setLoading(false);
      }
    };
    loadData();
  }, []);

  const filteredProducts = selectedFilter === 'All'
    ? products
    : products.filter((p) => p.categoryName === selectedFilter);

  if (loading) return <div className="min-h-screen bg-background flex items-center justify-center"><div className="animate-pulse text-accent font-serif">Cargando tienda...</div></div>;

  return (
    <div className="min-h-screen bg-background py-16">
      <div className="container mx-auto px-4 sm:px-6 lg:px-8">
        
        <div className="mb-12 text-center">
          <h1 className="font-serif text-5xl font-bold text-primary mb-4">Tienda Online</h1>
          <p className="text-gray-500">Productos profesionales para continuar tu rutina en casa.</p>
        </div>

        {/* Filtros */}
        <div className="flex flex-wrap justify-center gap-3 mb-12">
          <button
            onClick={() => setSelectedFilter('All')}
            className={`px-5 py-2 rounded-full text-sm font-medium transition-all ${
              selectedFilter === 'All' 
                ? 'bg-primary text-white shadow-lg' 
                : 'bg-white text-gray-500 border border-gray-200 hover:border-accent hover:text-accent'
            }`}
          >
            Todo
          </button>
          {categories.map((cat) => (
            <button
              key={cat.id}
              onClick={() => setSelectedFilter(cat.name)}
              className={`px-5 py-2 rounded-full text-sm font-medium transition-all ${
                selectedFilter === cat.name 
                  ? 'bg-primary text-white shadow-lg' 
                  : 'bg-white text-gray-500 border border-gray-200 hover:border-accent hover:text-accent'
              }`}
            >
              {cat.name}
            </button>
          ))}
        </div>

        {/* Grid de Productos */}
        {filteredProducts.length === 0 ? (
           <div className="text-center py-20 text-gray-400">No hay productos en esta categoría.</div>
        ) : (
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            {filteredProducts.map((product) => (
              <ProductoCard key={product.id} product={product} />
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

========== FILE: ./pages/ReservarTurnoPage.tsx ==========
import { useEffect, useState } from 'react';
import { useParams } from 'react-router-dom';
import { serviciosApi } from '../api/servicios';
import TurnoFlow from '../components/booking/TurnoFlow';
import type { Service } from '../types/domain';

export default function ReservarTurnoPage() {
  const { serviceSlug } = useParams<{ serviceSlug?: string }>(); // Opcional ahora
  const [service, setService] = useState<Service | null>(null);
  const [loading, setLoading] = useState(!!serviceSlug); // Solo carga si hay slug

  useEffect(() => {
    if (serviceSlug) {
      const loadService = async () => {
        try {
          setLoading(true);
          const services = await serviciosApi.getAll();
          const foundService = services.find((s) => s.slug === serviceSlug);
          if (foundService) setService(foundService);
        } catch (err) {
          console.error(err);
        } finally {
          setLoading(false);
        }
      };
      loadService();
    }
  }, [serviceSlug]);

  if (loading) {
    return (
      <div className="min-h-screen bg-background flex items-center justify-center">
        <div className="animate-pulse text-accent font-serif text-xl">Cargando agenda...</div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-background py-12">
      <div className="container mx-auto px-4">
        {/* Pasamos el servicio (puede ser null si es reserva genérica) */}
        <TurnoFlow service={service} />
      </div>
    </div>
  );
}

========== FILE: ./pages/ServiciosPage.tsx ==========
import { useEffect, useState } from 'react';
import { Link } from 'react-router-dom';
import { serviciosApi } from '../api/servicios';
import { categoriasApi } from '../api/categorias';
import type { Service, Category } from '../types/domain';
import { CategoryType } from '../types/domain';

export default function ServiciosPage() {
  const [services, setServices] = useState<Service[]>([]);
  const [categories, setCategories] = useState<Category[]>([]);
  const [selectedFilter, setSelectedFilter] = useState<string>('All');
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const loadData = async () => {
      try {
        setLoading(true);
        const [servicesData, categoriesData] = await Promise.all([
          serviciosApi.getAll(),
          categoriasApi.getByType(CategoryType.SERVICE),
        ]);
        setServices(servicesData);
        setCategories(categoriesData);
      } catch (err) {
        setError('No pudimos cargar los servicios. Por favor intentá nuevamente.');
        console.error(err);
      } finally {
        setLoading(false);
      }
    };
    loadData();
  }, []);

  const filteredServices = selectedFilter === 'All'
    ? services
    : services.filter((s) => s.categoryName === selectedFilter);

  if (loading) return <div className="min-h-screen flex items-center justify-center bg-background"><div className="animate-pulse text-accent font-serif text-xl">Cargando experiencias...</div></div>;
  if (error) return <div className="min-h-screen flex items-center justify-center text-red-400 bg-background">{error}</div>;

  return (
    <div className="min-h-screen bg-background py-16 lg:py-24">
      <div className="container mx-auto px-4 sm:px-6 lg:px-8">
        
        {/* Header */}
        <div className="text-center max-w-3xl mx-auto mb-16">
          <h1 className="font-serif text-5xl font-bold text-primary mb-6">
            Menú de Tratamientos
          </h1>
          <p className="text-gray-500 text-lg font-sans leading-relaxed">
            Protocolos exclusivos diseñados para la salud y belleza de tu piel.
          </p>
        </div>

        {/* Filtros */}
        <div className="flex flex-wrap justify-center gap-3 mb-16">
          <button
            onClick={() => setSelectedFilter('All')}
            className={`px-6 py-2 rounded-full text-sm font-medium transition-all duration-300 ${
              selectedFilter === 'All'
                ? 'bg-primary text-white shadow-lg'
                : 'bg-white text-gray-500 hover:text-accent border border-gray-100'
            }`}
          >
            Todos
          </button>
          {categories.map((cat) => (
            <button
              key={cat.id}
              onClick={() => setSelectedFilter(cat.name)}
              className={`px-6 py-2 rounded-full text-sm font-medium transition-all duration-300 ${
                selectedFilter === cat.name
                  ? 'bg-primary text-white shadow-lg'
                  : 'bg-white text-gray-500 hover:text-accent border border-gray-100'
              }`}
            >
              {cat.name}
            </button>
          ))}
        </div>

        {/* Grid de Servicios */}
        <div className="grid gap-6 max-w-5xl mx-auto">
          {filteredServices.map((service) => (
            <div
              key={service.id}
              className="group bg-white rounded-3xl p-4 shadow-sm hover:shadow-soft transition-all duration-300 flex flex-col md:flex-row gap-6 md:gap-8 items-center md:items-stretch"
            >
              {/* Imagen */}
              <div className="w-full md:w-1/3 aspect-[4/3] md:aspect-auto rounded-2xl overflow-hidden relative">
                <img
                  src={service.imageUrl || '/placeholder-service.jpg'}
                  alt={service.name}
                  className="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-700"
                  onError={(e) => (e.currentTarget.src = 'https://placehold.co/600x400/F9F7F5/E5989B?text=Servicio')}
                />
              </div>

              {/* Info */}
              <div className="flex-1 py-2 md:py-4 flex flex-col text-center md:text-left">
                <div className="mb-4">
                  <div className="flex flex-col md:flex-row md:items-center justify-between gap-2 mb-2">
                    <h3 className="font-sans text-2xl font-bold text-primary group-hover:text-accent transition-colors">
                      {service.name}
                    </h3>
                    <span className="text-xl font-bold text-primary font-sans">
                      ${service.price}
                    </span>
                  </div>
                  <p className="text-gray-500 text-sm leading-relaxed mb-4">
                    {service.description}
                  </p>
                  
                  <div className="flex items-center justify-center md:justify-start gap-4 text-sm text-gray-400">
                    <span className="flex items-center gap-1 bg-background px-3 py-1 rounded-full">
                      ⏱ {service.durationMinutes} min
                    </span>
                    {service.categoryName && (
                      <span className="bg-background px-3 py-1 rounded-full uppercase text-xs font-bold tracking-wider">
                        {service.categoryName}
                      </span>
                    )}
                  </div>
                </div>

                <div className="mt-auto pt-4 md:pt-0">
                  <Link
                    to={`/servicios/${service.slug}/reservar`}
                    className="inline-block w-full md:w-auto bg-accent text-white px-8 py-3 rounded-full font-medium hover:bg-primary transition-colors duration-300 text-center shadow-lg shadow-accent/20"
                  >
                    Agendar Cita
                  </Link>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

========== FILE: ./styles/index.css ==========
@import "tailwindcss/base";
@import "tailwindcss/components";
@import "tailwindcss/utilities";

@layer base {
  body {
    @apply bg-background text-primary font-sans antialiased;
  }

  h1, h2, h3, h4, h5, h6 {
    @apply font-serif font-semibold tracking-tight;
  }

  /* Scrollbar elegante y fina para el admin */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  ::-webkit-scrollbar-track {
    @apply bg-transparent;
  }
  ::-webkit-scrollbar-thumb {
    @apply bg-gray-300 rounded-full hover:bg-gray-400 transition;
  }

}

@layer components {
  .form-input {
    @apply w-full px-4 py-2.5 bg-white border border-gray-200 rounded-lg text-gray-900 focus:ring-2 focus:ring-primary/20 focus:border-primary focus:outline-none transition-all placeholder:text-gray-300;
  }
  
  .form-textarea {
    @apply w-full px-4 py-3 bg-white border border-gray-200 rounded-lg text-gray-900 focus:ring-2 focus:ring-primary/20 focus:border-primary focus:outline-none transition-all placeholder:text-gray-300 resize-y min-h-[100px];
  }
}

========== FILE: ./types/domain.ts ==========
/**
 * TypeScript domain types matching backend DTOs
 * All content in Spanish as per requirements
 */

// ==================== ENUMS (as const objects for erasableSyntaxOnly) ====================

export const BookingStatus = {
  PENDING: 'PENDING',
  CONFIRMED: 'CONFIRMED',
  CANCELLED: 'CANCELLED',
  COMPLETED: 'COMPLETED',
} as const;

export type BookingStatus = typeof BookingStatus[keyof typeof BookingStatus];

export const PaymentStatus = {
  PENDING: 'PENDING',
  PAID: 'PAID',
  FAILED: 'FAILED',
  REFUNDED: 'REFUNDED',
} as const;

export type PaymentStatus = typeof PaymentStatus[keyof typeof PaymentStatus];

export const OrderStatus = {
  PENDING: 'PENDING',
  PAID: 'PAID',
  PREPARING: 'PREPARING',
  READY: 'READY',
  DELIVERED: 'DELIVERED',
  CANCELLED: 'CANCELLED',
} as const;

export type OrderStatus = typeof OrderStatus[keyof typeof OrderStatus];

export const DeliveryType = {
  PICKUP: 'PICKUP',
  HOME_DELIVERY: 'HOME_DELIVERY',
} as const;

export type DeliveryType = typeof DeliveryType[keyof typeof DeliveryType];

export const CategoryType = {
  SERVICE: 'SERVICE',
  PRODUCT: 'PRODUCT',
} as const;

export type CategoryType = typeof CategoryType[keyof typeof CategoryType];

// ==================== CATALOG ====================

export interface Category {
  id: number;
  name: string;
  slug: string;
  description: string | null;
  type: CategoryType;
  isActive: boolean;
  createdAt: string;
}

export interface Service {
  id: number;
  name: string;
  slug: string;
  description: string;
  shortDescription: string | null;
  durationMinutes: number;
  price: number;
  categoryId: number | null;
  categoryName: string | null;
  isFeatured: boolean;
  isActive: boolean;
  imageUrl: string | null;
  createdAt: string;
  updatedAt: string;
}

export interface Product {
  id: number;
  name: string;
  slug: string;
  description: string;
  shortDescription: string | null;
  price: number;
  stock: number;
  categoryId: number | null;
  categoryName: string | null;
  isFeatured: boolean;
  isOffer: boolean;
  isTrending: boolean;
  isActive: boolean;
  imageUrl: string | null;
  createdAt: string;
  updatedAt: string;
}

// ==================== BOOKING ====================

export interface CustomerInfo {
  name: string;
  email: string;
  whatsapp: string;
  comments: string | null;
}

export interface TimeSlot {
  date: string; // YYYY-MM-DD
  time: string; // HH:mm
}

export interface Booking {
  id: number;
  bookingNumber: string;
  serviceId: number;
  serviceName?: string;
  customerName: string;
  customerEmail: string;
  customerWhatsApp: string;
  customerComments: string | null;
  
  bookingDate: string;
  bookingTime: string;

  durationMinutes: number;
  status: BookingStatus;
  paymentStatus: PaymentStatus;
  amount: number;
  mercadoPagoPreferenceId: string | null;
  mercadoPagoPaymentId: string | null;
  createdAt: string;
  updatedAt: string;
  confirmedAt: string | null;
  cancelledAt: string | null;
}

export interface CreateBookingRequest {
  serviceId: number;
  customerName: string;
  customerEmail: string;
  customerWhatsapp: string;
  customerComments: string | null;
  bookingDate: string; // YYYY-MM-DD
  bookingTime: string; // HH:mm
  durationMinutes: number;
  amount: number;
}

export interface BookingResponse {
  id: number;
  bookingNumber: string;
  serviceId: number;
  serviceName: string;
  customerInfo: CustomerInfo;
  timeSlot: TimeSlot;
  status: BookingStatus;
  paymentStatus: PaymentStatus;
  amount: number;
  mercadoPagoPreferenceId: string | null;
  createdAt: string;
}

// ==================== SALES / ORDERS ====================

export interface DeliveryInfo {
  deliveryType: DeliveryType;
  deliveryAddress: string | null;
  deliveryCity: string | null;
  deliveryProvince: string | null;
  deliveryPostalCode: string | null;
}

export interface OrderItem {
  id: number;
  productId: number;
  productName: string;
  productPrice: number;
  quantity: number;
  subtotal: number;
}

export interface Order {
  id: number;
  orderNumber: string;
  customerInfo: CustomerInfo;
  deliveryInfo: DeliveryInfo;
  items: OrderItem[];
  subtotal: number;
  deliveryCost: number;
  total: number;
  status: OrderStatus;
  paymentStatus: PaymentStatus;
  mercadoPagoPreferenceId: string | null;
  mercadoPagoPaymentId: string | null;
  createdAt: string;
  updatedAt: string;
}

export interface CreateOrderItemRequest {
  productId: number;
  quantity: number;
}

export interface CreateOrderRequest {
  customerName: string;
  customerEmail: string;
  customerWhatsapp: string;
  customerComments: string | null;
  deliveryType: DeliveryType;
  deliveryAddress: string | null;
  deliveryCity: string | null;
  deliveryProvince: string | null;
  deliveryPostalCode: string | null;
  items: CreateOrderItemRequest[];
}

export interface OrderResponse {
  id: number;
  orderNumber: string;
  customerInfo: CustomerInfo;
  deliveryInfo: DeliveryInfo;
  items: OrderItem[];
  subtotal: number;
  deliveryCost: number;
  total: number;
  status: OrderStatus;
  paymentStatus: PaymentStatus;
  mercadoPagoPreferenceId: string | null;
  createdAt: string;
}

// ==================== PAYMENT ====================

export interface PaymentPreferenceResponse {
  preferenceId: string;
  initPoint: string;
}

// ==================== CART (Frontend only) ====================

export interface CartItem {
  product: Product;
  quantity: number;
}

// ==================== AUTH ====================

export interface LoginRequest {
  username: string;
  password: string;
}

export interface LoginResponse {
  token: string;
  username: string;
}

// ==================== API RESPONSE ====================

export interface ApiResponse<T> {
  data: T;
  message: string | null;
  success: boolean;
}

export interface ErrorResponse {
  message: string;
  status: number;
  timestamp: string;
  details: string[] | null;
}

// ==================== CONFIG ====================

export interface ConfigEntry {
  key: string;
  value: string;
  description: string | null;
}

export interface DaySchedule {
  enabled: boolean;
  startTime: string; // "09:00"
  endTime: string;   // "18:00"
}

export interface WeeklySchedule {
  [key: string]: DaySchedule; // monday, tuesday, etc.
}

